from __future__ import division
from math import sin, cos, tan, pi

def dependent_qdot(_x, _params):
    """Linear mapping from lean rate, steer rate, front wheel rate to yaw rate, rear
    wheel rate, pitch rate, rear wheel contact point velocity in N[1] and N[2]
    directions.

    """
    q1d, q4d, q5d = _x
    rr, rf, lr, ls, lf, q0, q1, q3, q4 = _params
    c0 = cos(q0)
    c3 = cos(q3)
    s0 = sin(q0)
    s1 = sin(q1)
    c1 = cos(q1)
    c4 = cos(q4)
    s3 = sin(q3)
    s4 = sin(q4)
    e1c_s = rf*(s1*s4 - c1*c4*s3)/(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)
    e3c_s = rf*c1*c3/(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)
    _d00 = (-rr + (e3c_s + ls)*c3 - (lr + (e1c_s + lf)*c4)*s3)*s1 - (e1c_s + lf)*c1*s4
    _d01 = -rr
    _d02 = (e3c_s + ls)*c3 - (lr + (e1c_s + lf)*c4)*s3
    _d10 = (lr + (e1c_s + lf)*c4)*c3 + (e3c_s + ls)*s3
    _d12 = ((lr + (e1c_s + lf)*c4)*c3 + (e3c_s + ls)*s3)*s1
    _d22 = -((lr + (e1c_s + lf)*c4)*c3 + (e3c_s + ls)*s3)*c1
    _d31 = -rr*c0
    _d41 = -rr*s0
    _i01 = -(e1c_s + lf)*c3*s4
    _i02 = -e1c_s*s3 + e3c_s*c3*c4
    _i10 = (rr + (lr + (e1c_s + lf)*c4)*s3 - (e3c_s + ls)*c3)*c1 - (e1c_s + lf)*s1*s4
    _i11 = (e1c_s + lf)*(c1*c4 - s1*s3*s4)
    _i12 = e3c_s*(c1*s4 + c4*s1*s3) + e1c_s*c3*s1
    _i20 = (rr + (lr + (e1c_s + lf)*c4)*s3 - (e3c_s + ls)*c3)*s1 + (e1c_s + lf)*c1*s4
    _i21 = (e1c_s + lf)*(c4*s1 + c1*s3*s4)
    _i22 = e3c_s*(s1*s4 - c1*c4*s3) - e1c_s*c1*c3
    q0d = ((_d12*_i20 - _d22*_i10)*q1d + (_d12*_i21 - _d22*_i11)*q4d + (_d12*_i22 - _d22*_i12)*q5d)/(_d10*_d22)
    q2d = ((_d00*_d22*_i10 + _d02*_d10*_i20 - _d00*_d12*_i20)*q1d + (_d00*_d22*_i11 + _d02*_d10*_i21 - _d00*_d12*_i21 - _d10*_d22*_i01)*q4d + (_d00*_d22*_i12 + _d02*_d10*_i22 - _d00*_d12*_i22 - _d10*_d22*_i02)*q5d)/(_d01*_d10*_d22)
    q3d = (-_i20*q1d - _i21*q4d - _i22*q5d)/_d22
    q6d = ((_d00*_d12*_d31*_i20 - _d00*_d22*_d31*_i10 - _d02*_d10*_d31*_i20)*q1d + (_d00*_d12*_d31*_i22 + _d10*_d22*_d31*_i02 - _d00*_d22*_d31*_i12 - _d02*_d10*_d31*_i22)*q5d + (_d00*_d12*_d31*_i21 + _d10*_d22*_d31*_i01 - _d00*_d22*_d31*_i11 - _d02*_d10*_d31*_i21)*q4d)/(_d01*_d10*_d22*_d33)
    q7d = ((_d00*_d12*_d41*_i20 - _d00*_d22*_d41*_i10 - _d02*_d10*_d41*_i20)*q1d + (_d00*_d12*_d41*_i22 + _d10*_d22*_d41*_i02 - _d00*_d22*_d41*_i12 - _d02*_d10*_d41*_i22)*q5d + (_d00*_d12*_d41*_i21 + _d10*_d22*_d41*_i01 - _d00*_d22*_d41*_i11 - _d02*_d10*_d41*_i21)*q4d)/(_d01*_d10*_d22*_d44)
    return [q0d, q2d, q3d, q6d, q7d]

def kindiffs(_x):
    """Linear mapping from generalized speeds to time derivatives of coordinates.

    """
    # Unpack function arguments
    q0, q1, q3, q4 = _x

    # Trigonometric functions
    c0 = cos(q0)
    c1 = cos(q1)
    c3 = cos(q3)
    c4 = cos(q4)
    s0 = sin(q0)
    s3 = sin(q3)
    s4 = sin(q4)
    t1 = tan(q1)

    # Calculate return values
    q0d = c3*u2/c1 - s3*u0/c1
    q1d = c3*u0 + s3*u2
    q2d = s3*t1*u0 - c3*t1*u2 + u4
    q3d = s3*t1*u0 - c3*t1*u2 + u1
    q4d = -u2 + u3
    q5d = s4*u0 - c4*u1 + u5
    q6d = -rr*q2d*c0
    q7d = -rr*q2d*s0

    # Return calculated values
    return [q0d, q1d, q2d, q3d, q4d, q5d, q6d, q7d]

def speed_transform(_x, _params):
    """Linear mapping from independent generalized speeds to dependent generalized
speeds.

    """
    # Unpack function arguments
    u0, u3, u5 = _x

    # Unpack function parameters
    rr, rf, lr, ls, lf, l1, l2, l3, l4, q1, q3, q4 = _params

    # Trigonometric functions
    c1 = cos(q1)
    c3 = cos(q3)
    c4 = cos(q4)
    s1 = sin(q1)
    s3 = sin(q3)
    s4 = sin(q4)

    # Nested terms
    e1c_s = rf*(s1*s4 - c1*c4*s3)/(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)
    e3c_s = rf*c1*c3/(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)
    _b00 = e3c_s*c4*s4
    _b01 = ls + e3c_s*s4**2
    _b03 = -(e1c_s + lf)*s4
    _b04 = -rr*c3
    _b05 = e3c_s*c4
    _b10 = -ls + rr*c3 - e3c_s*c4**2
    _b12 = lr + rr*s3
    _b13 = (e1c_s + lf)*c4
    _b15 = e3c_s*s4
    _b20 = lf*s4
    _b21 = -lr - lf*c4
    _b24 = -rr*s3
    _b25 = -e1c_s

    # Calculate return values
    u1 = ((_b00*_b24 - _b04*_b20)*u0 + (_b05*_b24 - _b04*_b25)*u5 + _b03*_b24*u3)/(_b01*_b24 - _b04*_b21)
    u2 = ((_b00*_b03*_b24 + _b01*_b13*_b24 - _b04*_b13*_b21)*u3 + (_b00*_b05*_b24 + _b01*_b15*_b24 - _b00*_b04*_b25 - _b04*_b15*_b21)*u5 + (_b00**2*_b24 + _b01*_b10*_b24 - _b00*_b04*_b20 - _b04*_b10*_b21)*u0)/(_b01*_b12*_b24 - _b04*_b12*_b21)
    u4 = ((_b01*_b20 - _b00*_b21)*u0 + (_b01*_b25 - _b05*_b21)*u5 - _b03*_b21*u3)/(_b01*_b24 - _b04*_b21)

    # Return calculated values
    return [u1, u2, u4]

def eoms(_x, t, _params):
    """Equations of motion for a benchmark bicycle.

    """
    # Unpack function arguments
    q0, q1, q2, q3, q4, q5, q6, q7, u0, u3, u5 = _x

    # Unpack function parameters
    rr, rf, lr, ls, lf, l1, l2, l3, l4, mcd, mef, IC22, ICD11, ID13, ICD33, ID22, IEF11, IE13, IEF33, IE22, IF22, g = _params

    # Trigonometric functions
    c0 = cos(q0)
    c1 = cos(q1)
    c3 = cos(q3)
    c4 = cos(q4)
    s0 = sin(q0)
    s1 = sin(q1)
    s3 = sin(q3)
    s4 = sin(q4)
    t1 = tan(q1)

    # Nested terms
    e1c_s = rf*(s1*s4 - c1*c4*s3)/(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)
    e1cd = (rf*(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)*(q1d*c1*s4 + q4d*c4*s1 + q1d*c4*s1*s3 + q4d*c1*s3*s4 - q3d*c1*c3*c4) + rf*(s1*s4 - c1*c4*s3)*(c4*s1 + c1*s3*s4)*(-2*q4d*s1*s4 + 2*q1d*c1*c4 - 2*q1d*s1*s3*s4 + 2*q3d*c1*c3*s4 + 2*q4d*c1*c4*s3)/(2*(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)))/(1 - (c4*s1 + c1*s3*s4)**2)
    e3c_s = rf*c1*c3/(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)
    e3cd = ((1 - (c4*s1 + c1*s3*s4)**2)**(1/2)*(-rf*q1d*c3*s1 - rf*q3d*c1*s3) + rf*(c4*s1 + c1*s3*s4)*(-2*q4d*s1*s4 + 2*q1d*c1*c4 - 2*q1d*s1*s3*s4 + 2*q3d*c1*c3*s4 + 2*q4d*c1*c4*s3)*c1*c3/(2*(1 - (c4*s1 + c1*s3*s4)**2)**(1/2)))/(1 - (c4*s1 + c1*s3*s4)**2)
    _b00 = e3c_s*c4*s4
    _b01 = ls + e3c_s*s4**2
    _b03 = -(e1c_s + lf)*s4
    _b04 = -rr*c3
    _b05 = e3c_s*c4
    _b10 = -ls + rr*c3 - e3c_s*c4**2
    _b12 = lr + rr*s3
    _b13 = (e1c_s + lf)*c4
    _b15 = e3c_s*s4
    _b20 = lf*s4
    _b21 = -lr - lf*c4
    _b24 = -rr*s3
    _b25 = -e1c_s
    u1 = ((_b00*_b24 - _b04*_b20)*u0 + (_b05*_b24 - _b04*_b25)*u5 + _b03*_b24*u3)/(_b01*_b24 - _b04*_b21)
    u2 = ((_b00*_b03*_b24 + _b01*_b13*_b24 - _b04*_b13*_b21)*u3 + (_b00*_b05*_b24 + _b01*_b15*_b24 - _b00*_b04*_b25 - _b04*_b15*_b21)*u5 + (_b00**2*_b24 + _b01*_b10*_b24 - _b00*_b04*_b20 - _b04*_b10*_b21)*u0)/(_b01*_b12*_b24 - _b04*_b12*_b21)
    u4 = ((_b01*_b20 - _b00*_b21)*u0 + (_b01*_b25 - _b05*_b21)*u5 - _b03*_b21*u3)/(_b01*_b24 - _b04*_b21)
    _b00d = e3c_s*c4**2*q4d + e3cd*c4*s4 - e3c_s*s4**2*q4d
    _b01d = 2*e3c_s*q4d*c4*s4 + e3cd*s4**2
    _b03d = -e1cd*s4 - (e1c_s + lf)*q4d*c4
    _b04d = rr*q3d*s3
    _b05d = e3cd*c4 - e3c_s*q4d*s4
    _b10d = -rr*q3d*s3 + 2*e3c_s*q4d*c4*s4 - e3cd*c4**2
    _b12d = rr*q3d*c3
    _b13d = e1cd*c4 - (e1c_s + lf)*q4d*s4
    _b15d = e3cd*s4 + e3c_s*q4d*c4
    _b20d = lf*q4d*c4
    _b21d = lf*q4d*s4
    _b24d = -rr*q3d*c3
    _b25d = -e1cd
    T_con00 = _b00*_b24/(_b01*_b24 - _b04*_b21) - _b04*_b20/(_b01*_b24 - _b04*_b21)
    T_con01 = _b03*_b24/(_b01*_b24 - _b04*_b21)
    T_con02 = _b05*_b24/(_b01*_b24 - _b04*_b21) - _b04*_b25/(_b01*_b24 - _b04*_b21)
    T_con10 = _b10/_b12 + _b00**2*_b24/((_b01*_b24 - _b04*_b21)*_b12) - _b00*_b04*_b20/((_b01*_b24 - _b04*_b21)*_b12)
    T_con11 = _b13/_b12 + _b00*_b03*_b24/((_b01*_b24 - _b04*_b21)*_b12)
    T_con12 = _b15/_b12 + _b00*_b05*_b24/((_b01*_b24 - _b04*_b21)*_b12) - _b00*_b04*_b25/((_b01*_b24 - _b04*_b21)*_b12)
    T_con20 = _b01*_b20/(_b01*_b24 - _b04*_b21) - _b00*_b21/(_b01*_b24 - _b04*_b21)
    T_con21 = -_b03*_b21/(_b01*_b24 - _b04*_b21)
    T_con22 = _b01*_b25/(_b01*_b24 - _b04*_b21) - _b05*_b21/(_b01*_b24 - _b04*_b21)
    T_con00d = ((_b01*_b24 - _b04*_b21)*(_b00d*_b24 + _b24d*_b00 - _b04d*_b20 - _b20d*_b04) - (_b00*_b24 - _b04*_b20)*(_b01d*_b24 + _b24d*_b01 - _b04d*_b21 - _b21d*_b04))/(_b01*_b24 - _b04*_b21)**2
    T_con01d = ((_b03d*_b24 + _b24d*_b03)*(_b01*_b24 - _b04*_b21) - (_b01d*_b24 + _b24d*_b01 - _b04d*_b21 - _b21d*_b04)*_b03*_b24)/(_b01*_b24 - _b04*_b21)**2
    T_con02d = ((_b01*_b24 - _b04*_b21)*(_b05d*_b24 + _b24d*_b05 - _b04d*_b25 - _b25d*_b04) - (_b05*_b24 - _b04*_b25)*(_b01d*_b24 + _b24d*_b01 - _b04d*_b21 - _b21d*_b04))/(_b01*_b24 - _b04*_b21)**2
    T_con10d = ((_b01*_b12*_b24 - _b04*_b12*_b21)*(_b01d*_b10*_b24 + _b10d*_b01*_b24 + _b24d*_b01*_b10 - _b00d*_b04*_b20 - _b04d*_b00*_b20 - _b04d*_b10*_b21 - _b10d*_b04*_b21 - _b20d*_b00*_b04 - _b21d*_b04*_b10 + 2*_b00d*_b00*_b24 + _b24d*_b00**2) - (_b00**2*_b24 + _b01*_b10*_b24 - _b00*_b04*_b20 - _b04*_b10*_b21)*(_b01d*_b12*_b24 + _b12d*_b01*_b24 + _b24d*_b01*_b12 - _b04d*_b12*_b21 - _b12d*_b04*_b21 - _b21d*_b04*_b12))/(_b01*_b12*_b24 - _b04*_b12*_b21)**2
    T_con11d = ((_b01*_b12*_b24 - _b04*_b12*_b21)*(_b00d*_b03*_b24 + _b01d*_b13*_b24 + _b03d*_b00*_b24 + _b13d*_b01*_b24 + _b24d*_b00*_b03 + _b24d*_b01*_b13 - _b04d*_b13*_b21 - _b13d*_b04*_b21 - _b21d*_b04*_b13) - (_b00*_b03*_b24 + _b01*_b13*_b24 - _b04*_b13*_b21)*(_b01d*_b12*_b24 + _b12d*_b01*_b24 + _b24d*_b01*_b12 - _b04d*_b12*_b21 - _b12d*_b04*_b21 - _b21d*_b04*_b12))/(_b01*_b12*_b24 - _b04*_b12*_b21)**2
    T_con12d = ((_b01*_b12*_b24 - _b04*_b12*_b21)*(_b00d*_b05*_b24 + _b01d*_b15*_b24 + _b05d*_b00*_b24 + _b15d*_b01*_b24 + _b24d*_b00*_b05 + _b24d*_b01*_b15 - _b00d*_b04*_b25 - _b04d*_b00*_b25 - _b04d*_b15*_b21 - _b15d*_b04*_b21 - _b21d*_b04*_b15 - _b25d*_b00*_b04) - (_b00*_b05*_b24 + _b01*_b15*_b24 - _b00*_b04*_b25 - _b04*_b15*_b21)*(_b01d*_b12*_b24 + _b12d*_b01*_b24 + _b24d*_b01*_b12 - _b04d*_b12*_b21 - _b12d*_b04*_b21 - _b21d*_b04*_b12))/(_b01*_b12*_b24 - _b04*_b12*_b21)**2
    T_con20d = ((_b01*_b24 - _b04*_b21)*(_b01d*_b20 + _b20d*_b01 - _b00d*_b21 - _b21d*_b00) - (_b01*_b20 - _b00*_b21)*(_b01d*_b24 + _b24d*_b01 - _b04d*_b21 - _b21d*_b04))/(_b01*_b24 - _b04*_b21)**2
    T_con21d = ((-_b03d*_b21 - _b21d*_b03)*(_b01*_b24 - _b04*_b21) + (_b01d*_b24 + _b24d*_b01 - _b04d*_b21 - _b21d*_b04)*_b03*_b21)/(_b01*_b24 - _b04*_b21)**2
    T_con22d = ((_b01*_b24 - _b04*_b21)*(_b01d*_b25 + _b25d*_b01 - _b05d*_b21 - _b21d*_b05) - (_b01*_b25 - _b05*_b21)*(_b01d*_b24 + _b24d*_b01 - _b04d*_b21 - _b21d*_b04))/(_b01*_b24 - _b04*_b21)**2
    _M00 = -ICD11 + T_con00*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con00*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4) + T_con00*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4) + T_con10*(-ID13 - ICD33*T_con10) + (l4*mef*c4 - e3c_s*mef*c4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + (l2*mcd - mcd*rr*c3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3) - ID13*T_con10 + IE22*(-s4 + T_con00*c4)*s4 + T_con10*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3) - IEF11*(T_con00*s4 + c4)*c4 + l4*mef*(-l4*s4 + T_con00*l4*c4)*s4 - l3*mef*(l3*s4 - T_con00*l3*c4)*s4 - ID22*T_con00**2
    _M01 = T_con01*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con01*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4) + T_con01*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4) + T_con11*(-ID13 - ICD33*T_con10) + T_con11*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3) - ID22*T_con00*T_con01
    _M02 = T_con02*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con02*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4) + T_con02*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4) + T_con12*(-ID13 - ICD33*T_con10) + T_con12*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3) - ID22*T_con00*T_con02
    _M10 = T_con00*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con00*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2) + T_con00*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2) + (l4*mef*c4 - e3c_s*mef*c4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - ID13*T_con11 - IE13*c4 + T_con11*(l1 + rr*s3)*(l2*mcd - mcd*rr*c3) - ICD33*T_con10*T_con11 - ID22*T_con00*T_con01 + IE22*T_con01*c4*s4 + T_con10*T_con11*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3) - IEF11*T_con01*c4*s4 + T_con01*mef*l3**2*c4*s4 + T_con01*mef*l4**2*c4*s4
    _M11 = T_con01*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con01*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2) + T_con01*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2) + T_con11**2*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3) - ICD33*T_con11**2 - ID22*T_con01**2
    _M12 = T_con02*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con02*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2) + T_con02*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2) - ICD33*T_con11*T_con12 - ID22*T_con01*T_con02 + T_con11*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3)
    _M20 = T_con00*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con00*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2) + T_con00*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4) - ID13*T_con12 + T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*c4 - e3c_s*mef*c4) + T_con12*(l1 + rr*s3)*(l2*mcd - mcd*rr*c3) - ICD33*T_con10*T_con12 - ID22*T_con00*T_con02 + IE22*T_con02*c4*s4 + T_con10*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3) + l4*mef*(-e3c_s + T_con02*l4*c4)*s4 - IEF11*T_con02*c4*s4 - l3*mef*(e1c_s - T_con02*l3*c4)*s4
    _M21 = T_con01*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con01*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2) + T_con01*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4) - ICD33*T_con11*T_con12 - ID22*T_con01*T_con02 + T_con11*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3)
    _M22 = T_con02*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con02*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2) + T_con02*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4) + T_con12**2*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3) - ICD33*T_con12**2 - ID22*T_con02**2

    # Calculate return values
    q0d = c3*u2/c1 - s3*u0/c1
    q1d = c3*u0 + s3*u2
    q2d = s3*t1*u0 - c3*t1*u2 + u4
    q3d = s3*t1*u0 - c3*t1*u2 + u1
    q4d = -u2 + u3
    q5d = s4*u0 - c4*u1 + u5
    q6d = -rr*q2d*c0
    q7d = -rr*q2d*s0
    u0d = (_M02*_M21 - _M01*_M22)*(-u0**2*(IE22*c4*s4 - IE13*c4*s4 - IEF11*c4*s4) - u0**2*(-T_con01*l3*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2)*c4 + l3*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4*s4 + T_con01*l3*l4*mef*s4**2*c4) - u1**2*(l1*mcd*(T_con01*l2 - T_con21*rr*c3) + l2*mcd*(-T_con01*l1 - T_con21*rr*s3)) - u1**2*(IE13*c4*s4 + IEF11*c4*s4 - IE22*c4*s4) - u1**2*(-T_con01*l3*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2)*c4 - l3*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4*s4 + T_con01*l3*l4*mef*c4**3) - (-IEF33 - IE13*T_con01*s4)*u3d - (T_con01d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con11*T_con11d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u3 - (T_con02d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con11*T_con12d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u5 - (-ICD33*T_con10d*T_con11 - ID22*T_con00d*T_con01)*u0 - (-ICD33*T_con11*T_con11d - ID22*T_con01*T_con01d)*u3 - (-ICD33*T_con11*T_con12d - ID22*T_con01*T_con02d)*u5 - (T_con00d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con10d*T_con11*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u0 - (mcd*rr*(T_con01*l2 - T_con21*rr*c3)*c3 + mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*s3)*u4d - (T_con01*e1c_s*l3*mef*c4 + T_con01*e3c_s*l4*mef*c4)*u5d + IC22*T_con21*u4d - T_con00d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u0 - T_con00d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u0 - T_con01d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u3 - T_con01d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u3 - T_con02d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u5 - T_con02d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u5 - u0**2*(-T_con01*l1 - T_con21*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(T_con01*l2 - T_con21*rr*c3)*(l1*mcd + mcd*rr*s3) - (e1c_s*mef - l3*mef)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*u3d - ((T_con01*l2 - T_con21*rr*c3)*(-l2*mcd + mcd*rr*c3) + (-T_con01*l1 - T_con21*rr*s3)*(-l1*mcd - mcd*rr*s3))*u0*u2 - (T_con01*(IEF33*c4 - IEF11*c4)*c4 + T_con01*(IE13*s4 + IEF33*s4 - IE22*s4)*s4)*u0*u3 - (T_con01*(IEF33*s4 - IEF11*s4)*c4 + T_con01*(IE22*c4 - IE13*c4 - IEF33*c4)*s4)*u1*u3 - (mcd*rr*(T_con01*l2 - T_con21*rr*c3)*s3 - mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*c3)*u1*u4 - (mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*c3 - mcd*rr*(T_con01*l2 - T_con21*rr*c3)*s3)*q3d*u4 - ((l3*mef*s4**2 - l3*mef*c4**2)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - 2*T_con01*l3*l4*mef*c4**2*s4 + 2*T_con01*e3c_s*l3*mef*c4**2*s4)*u0*u1 - (-IE13*c4 + IE22*T_con01*c4*s4 - IEF11*T_con01*c4*s4)*q4d*u1 - (IE13*s4 + IE22*T_con01*c4**2 + IEF11*T_con01*s4**2)*q4d*u0 - (T_con01*l4*(e3c_s*mef*c4 - l4*mef*c4)*c4 + l4*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*s4 - T_con01*l3*(e1c_s*mef*c4 - l3*mef*c4)*c4)*u0*u3 - (T_con01*l4*(e3c_s*mef*s4 - l4*mef*s4)*c4 - T_con01*l3*(e1c_s*mef*s4 - l3*mef*s4)*c4 - l4*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4)*u1*u3 - ((e3c_s*mef*s4 - l4*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + T_con01*mef*l3**2*c4**2 + T_con01*mef*l4**2*c4**2)*q4d*u0 - (e1c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4 + T_con01*e1c_s*l4*mef*c4*s4 - T_con01*e3c_s*l3*mef*c4*s4)*u0*u5 - (e1c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*s4 + T_con01*e3c_s*l3*mef*c4**2 - T_con01*e1c_s*l4*mef*c4**2)*u1*u5 - ((l4*mef*c4 - e3c_s*mef*c4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + T_con01*mef*l3**2*c4*s4 + T_con01*mef*l4**2*c4*s4)*q4d*u1 - (IE13*c4**2 + IE22*s4**2 + IEF11*c4**2 - IE13*s4**2 - IE22*c4**2 - IEF11*s4**2)*u0*u1 + IC22*T_con11*u0*u4 + IF22*c4*u0*u5 + IF22*s4*u1*u5 - T_con01*(ICD33 - ICD11)*u0*u2 - T_con11*(ICD11 + ID13 - ID22)*u0*u1 - g*mef*(c4*s1 + c1*s3*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + g*mcd*(T_con01*l2 - T_con21*rr*c3)*c1*s3 - IF22*T_con01*s4*u3*u5 - T_con01*l4*u3**2*(l3*mef - e1c_s*mef)*c4 - T_con11*g*mcd*(l1 + rr*s3)*s1 - e3c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*u3*u5 - g*mcd*(-T_con01*l1 - T_con21*rr*s3)*c1*c3 + T_con11*l1*mcd*(l1 + rr*s3)*u0*u1 + T_con11*l2*mcd*(l1 + rr*s3)*u1*u2 - T_con01*g*l4*mef*(s1*s4 - c1*c4*s3)*c4 + T_con01*g*l3*mef*c1*c3*c4 + T_con11*mcd*rr*(l1 + rr*s3)*q3d*c3*u2 + T_con11*mcd*rr*(l1 + rr*s3)*s3*u0*u4 - T_con11*mcd*rr*(l1 + rr*s3)*q3d*s3*u0 - T_con11*mcd*rr*(l1 + rr*s3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20) + (_M01*_M12 - _M02*_M11)*(IF22*u5d - u0**2*((e1c_s - T_con02*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2) + l3*mef*s4**2*(-e3c_s + T_con02*l4*c4) + T_con02*l3*mef*(e3c_s*s4 - l4*s4)*c4*s4) - u1**2*(l1*mcd*(T_con02*l2 - T_con22*rr*c3) + l2*mcd*(-T_con02*l1 - T_con22*rr*s3)) - u1**2*((e1c_s - T_con02*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2) + l3*mef*c4**2*(-e3c_s + T_con02*l4*c4) - T_con02*l3*mef*(e3c_s*s4 - l4*s4)*c4*s4) - (T_con00d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con10d*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u0 - (T_con01d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con11d*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u3 - (T_con02d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con12*T_con12d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u5 - (-ICD33*T_con10d*T_con12 - ID22*T_con00d*T_con02)*u0 - (-ICD33*T_con11d*T_con12 - ID22*T_con01d*T_con02)*u3 - (-ICD33*T_con12*T_con12d - ID22*T_con02*T_con02d)*u5 - (e3c_s*mef*(-e3c_s + T_con02*l4*c4) - e1c_s*mef*(e1c_s - T_con02*l3*c4))*u5d - (mcd*rr*(T_con02*l2 - T_con22*rr*c3)*c3 + mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*s3)*u4d + IC22*T_con22*u4d - T_con00d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u0 - T_con00d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u0 - T_con01d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u3 - T_con01d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u3 - T_con02d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u5 - T_con02d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u5 - u0**2*(-T_con02*l1 - T_con22*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(T_con02*l2 - T_con22*rr*c3)*(l1*mcd + mcd*rr*s3) - u3**2*(-e3c_s + T_con02*l4*c4)*(l3*mef - e1c_s*mef) - ((T_con02*l2 - T_con22*rr*c3)*(-l2*mcd + mcd*rr*c3) + (-T_con02*l1 - T_con22*rr*s3)*(-l1*mcd - mcd*rr*s3))*u0*u2 - (IE22*T_con02*c4**2 + IEF11*T_con02*s4**2)*q4d*u0 - (T_con02*(IEF33*c4 - IEF11*c4)*c4 + T_con02*(IE13*s4 + IEF33*s4 - IE22*s4)*s4)*u0*u3 - (T_con02*(IEF33*s4 - IEF11*s4)*c4 + T_con02*(IE22*c4 - IE13*c4 - IEF33*c4)*s4)*u1*u3 - (IE22*T_con02*c4*s4 - IEF11*T_con02*c4*s4)*q4d*u1 - (mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*c3 - mcd*rr*(T_con02*l2 - T_con22*rr*c3)*s3)*q3d*u4 - (mcd*rr*(T_con02*l2 - T_con22*rr*c3)*s3 - mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*c3)*u1*u4 - ((e1c_s - T_con02*l3*c4)*(e1c_s*mef*c4 - l3*mef*c4) + (-e3c_s + T_con02*l4*c4)*(e3c_s*mef*c4 - l4*mef*c4) + T_con02*l4*mef*(e3c_s*s4 - l4*s4)*s4)*u0*u3 - ((e1c_s - T_con02*l3*c4)*(e1c_s*mef*s4 - l3*mef*s4) + (-e3c_s + T_con02*l4*c4)*(e3c_s*mef*s4 - l4*mef*s4) - T_con02*l4*mef*(e3c_s*s4 - l4*s4)*c4)*u1*u3 - (T_con02*(e3c_s*s4 - l4*s4)*(e3c_s*mef*s4 - l4*mef*s4) + l4*mef*(-e3c_s + T_con02*l4*c4)*c4 - l3*mef*(e1c_s - T_con02*l3*c4)*c4)*q4d*u0 - (e1c_s*mef*(-e3c_s + T_con02*l4*c4)*s4 + e3c_s*mef*(e1c_s - T_con02*l3*c4)*s4 + T_con02*e1c_s*mef*(e3c_s*s4 - l4*s4)*c4)*u0*u5 - (T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*c4 - e3c_s*mef*c4) + l4*mef*(-e3c_s + T_con02*l4*c4)*s4 - l3*mef*(e1c_s - T_con02*l3*c4)*s4)*q4d*u1 - (-e1c_s*mef*(-e3c_s + T_con02*l4*c4)*c4 - e3c_s*mef*(e1c_s - T_con02*l3*c4)*c4 + T_con02*e1c_s*mef*(e3c_s*s4 - l4*s4)*s4)*u1*u5 - (T_con02*(e3c_s*s4 - l4*s4)*(l3*mef*s4**2 - l3*mef*c4**2) - 2*e3c_s*mef*(e1c_s - T_con02*l3*c4)*c4*s4 - 2*l3*mef*(-e3c_s + T_con02*l4*c4)*c4*s4)*u0*u1 + IC22*T_con12*u0*u4 + IE13*T_con02*u3d*s4 - T_con02*(ICD33 - ICD11)*u0*u2 - T_con02*(e1c_s*mef - l3*mef)*(e3c_s*s4 - l4*s4)*u3d - T_con12*(ICD11 + ID13 - ID22)*u0*u1 - g*mef*(-e3c_s + T_con02*l4*c4)*(s1*s4 - c1*c4*s3) + g*mcd*(T_con02*l2 - T_con22*rr*c3)*c1*s3 - IF22*T_con02*s4*u3*u5 - T_con02*g*mef*(e3c_s*s4 - l4*s4)*(c4*s1 + c1*s3*s4) - T_con12*g*mcd*(l1 + rr*s3)*s1 - g*mcd*(-T_con02*l1 - T_con22*rr*s3)*c1*c3 - g*mef*(e1c_s - T_con02*l3*c4)*c1*c3 + T_con12*l1*mcd*(l1 + rr*s3)*u0*u1 + T_con12*l2*mcd*(l1 + rr*s3)*u1*u2 - T_con02*e3c_s*mef*(e3c_s*s4 - l4*s4)*u3*u5 + T_con12*mcd*rr*(l1 + rr*s3)*q3d*c3*u2 + T_con12*mcd*rr*(l1 + rr*s3)*s3*u0*u4 - T_con12*mcd*rr*(l1 + rr*s3)*q3d*s3*u0 - T_con12*mcd*rr*(l1 + rr*s3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20) + (_M11*_M22 - _M12*_M21)*(-u0**2*((l3*s4 - T_con00*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2) + l3*mef*s4**2*(-l4*s4 + T_con00*l4*c4) + l3*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4*s4) - u1**2*(l1*mcd*(T_con00*l2 - T_con20*rr*c3) + l2*mcd*(-T_con00*l1 - T_con20*rr*s3)) - u1**2*((l3*s4 - T_con00*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2) + l3*mef*c4**2*(-l4*s4 + T_con00*l4*c4) - l3*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4*s4) - (T_con00d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con10d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u0 - (T_con02d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con12d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u5 - (T_con01d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con11d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u3 - (T_con10d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con00d)*u0 - (T_con11d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con01d)*u3 - (T_con12d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con02d)*u5 - (e3c_s*mef*(-l4*s4 + T_con00*l4*c4) - e1c_s*mef*(l3*s4 - T_con00*l3*c4))*u5d - (mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*s3 + mcd*rr*(T_con00*l2 - T_con20*rr*c3)*c3)*u4d + IC22*T_con20*u4d + IE13*(T_con00*s4 + c4)*u3d - IC22*u2*u4 - T_con00d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u0 - T_con00d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u0 - T_con01d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u3 - T_con01d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u3 - T_con02d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u5 - T_con02d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u5 - u0**2*(-T_con00*l1 - T_con20*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(l1*mcd + mcd*rr*s3)*(T_con00*l2 - T_con20*rr*c3) - u3**2*(l3*mef - e1c_s*mef)*(-l4*s4 + T_con00*l4*c4) - (e1c_s*mef - l3*mef)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*u3d - ((-s4 + T_con00*c4)*(IEF33*c4 - IEF11*c4) + (T_con00*s4 + c4)*(IE13*s4 + IEF33*s4 - IE22*s4))*u0*u3 - ((IEF33*s4 - IEF11*s4)*(-s4 + T_con00*c4) + (T_con00*s4 + c4)*(IE22*c4 - IE13*c4 - IEF33*c4))*u1*u3 - ((-T_con00*l1 - T_con20*rr*s3)*(-l1*mcd - mcd*rr*s3) + (-l2*mcd + mcd*rr*c3)*(T_con00*l2 - T_con20*rr*c3))*u0*u2 - (IE22*(-s4 + T_con00*c4)*c4 + IEF11*(T_con00*s4 + c4)*s4)*q4d*u0 - (IE22*(-s4 + T_con00*c4)*s4 - IEF11*(T_con00*s4 + c4)*c4)*q4d*u1 - (mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*c3 - mcd*rr*(T_con00*l2 - T_con20*rr*c3)*s3)*q3d*u4 - (mcd*rr*(T_con00*l2 - T_con20*rr*c3)*s3 - mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*c3)*u1*u4 - (ID22 - ICD33 - ID13)*u1*u2 - ((-l4*s4 + T_con00*l4*c4)*(e3c_s*mef*c4 - l4*mef*c4) + (e1c_s*mef*c4 - l3*mef*c4)*(l3*s4 - T_con00*l3*c4) + l4*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*s4)*u0*u3 - ((-l4*s4 + T_con00*l4*c4)*(e3c_s*mef*s4 - l4*mef*s4) + (e1c_s*mef*s4 - l3*mef*s4)*(l3*s4 - T_con00*l3*c4) - l4*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4)*u1*u3 - ((l3*mef*s4**2 - l3*mef*c4**2)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) - 2*e3c_s*mef*(l3*s4 - T_con00*l3*c4)*c4*s4 - 2*l3*mef*(-l4*s4 + T_con00*l4*c4)*c4*s4)*u0*u1 - ((e3c_s*mef*s4 - l4*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l4*mef*(-l4*s4 + T_con00*l4*c4)*c4 - l3*mef*(l3*s4 - T_con00*l3*c4)*c4)*q4d*u0 - (e1c_s*mef*(-l4*s4 + T_con00*l4*c4)*s4 + e1c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4 + e3c_s*mef*(l3*s4 - T_con00*l3*c4)*s4)*u0*u5 - (e1c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*s4 - e1c_s*mef*(-l4*s4 + T_con00*l4*c4)*c4 - e3c_s*mef*(l3*s4 - T_con00*l3*c4)*c4)*u1*u5 - ((l4*mef*c4 - e3c_s*mef*c4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l4*mef*(-l4*s4 + T_con00*l4*c4)*s4 - l3*mef*(l3*s4 - T_con00*l3*c4)*s4)*q4d*u1 + IC22*T_con10*u0*u4 - IF22*(T_con00*s4 + c4)*u3*u5 - T_con00*(ICD33 - ICD11)*u0*u2 - T_con10*(ICD11 + ID13 - ID22)*u0*u1 - g*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*s1 - g*mef*(s1*s4 - c1*c4*s3)*(-l4*s4 + T_con00*l4*c4) - g*mef*(c4*s1 + c1*s3*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + g*mcd*(T_con00*l2 - T_con20*rr*c3)*c1*s3 + l1*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*u0*u1 + l2*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*u1*u2 - e3c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*u3*u5 - g*mcd*(-T_con00*l1 - T_con20*rr*s3)*c1*c3 - g*mef*(l3*s4 - T_con00*l3*c4)*c1*c3 + mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*q3d*c3*u2 + mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*s3*u0*u4 - mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*q3d*s3*u0 - mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20)
    u3d = (_M02*_M10 - _M00*_M12)*(IF22*u5d - u0**2*((e1c_s - T_con02*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2) + l3*mef*s4**2*(-e3c_s + T_con02*l4*c4) + T_con02*l3*mef*(e3c_s*s4 - l4*s4)*c4*s4) - u1**2*(l1*mcd*(T_con02*l2 - T_con22*rr*c3) + l2*mcd*(-T_con02*l1 - T_con22*rr*s3)) - u1**2*((e1c_s - T_con02*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2) + l3*mef*c4**2*(-e3c_s + T_con02*l4*c4) - T_con02*l3*mef*(e3c_s*s4 - l4*s4)*c4*s4) - (T_con00d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con10d*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u0 - (T_con01d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con11d*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u3 - (T_con02d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con12*T_con12d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u5 - (-ICD33*T_con10d*T_con12 - ID22*T_con00d*T_con02)*u0 - (-ICD33*T_con11d*T_con12 - ID22*T_con01d*T_con02)*u3 - (-ICD33*T_con12*T_con12d - ID22*T_con02*T_con02d)*u5 - (e3c_s*mef*(-e3c_s + T_con02*l4*c4) - e1c_s*mef*(e1c_s - T_con02*l3*c4))*u5d - (mcd*rr*(T_con02*l2 - T_con22*rr*c3)*c3 + mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*s3)*u4d + IC22*T_con22*u4d - T_con00d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u0 - T_con00d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u0 - T_con01d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u3 - T_con01d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u3 - T_con02d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u5 - T_con02d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u5 - u0**2*(-T_con02*l1 - T_con22*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(T_con02*l2 - T_con22*rr*c3)*(l1*mcd + mcd*rr*s3) - u3**2*(-e3c_s + T_con02*l4*c4)*(l3*mef - e1c_s*mef) - ((T_con02*l2 - T_con22*rr*c3)*(-l2*mcd + mcd*rr*c3) + (-T_con02*l1 - T_con22*rr*s3)*(-l1*mcd - mcd*rr*s3))*u0*u2 - (IE22*T_con02*c4**2 + IEF11*T_con02*s4**2)*q4d*u0 - (T_con02*(IEF33*c4 - IEF11*c4)*c4 + T_con02*(IE13*s4 + IEF33*s4 - IE22*s4)*s4)*u0*u3 - (T_con02*(IEF33*s4 - IEF11*s4)*c4 + T_con02*(IE22*c4 - IE13*c4 - IEF33*c4)*s4)*u1*u3 - (IE22*T_con02*c4*s4 - IEF11*T_con02*c4*s4)*q4d*u1 - (mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*c3 - mcd*rr*(T_con02*l2 - T_con22*rr*c3)*s3)*q3d*u4 - (mcd*rr*(T_con02*l2 - T_con22*rr*c3)*s3 - mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*c3)*u1*u4 - ((e1c_s - T_con02*l3*c4)*(e1c_s*mef*c4 - l3*mef*c4) + (-e3c_s + T_con02*l4*c4)*(e3c_s*mef*c4 - l4*mef*c4) + T_con02*l4*mef*(e3c_s*s4 - l4*s4)*s4)*u0*u3 - ((e1c_s - T_con02*l3*c4)*(e1c_s*mef*s4 - l3*mef*s4) + (-e3c_s + T_con02*l4*c4)*(e3c_s*mef*s4 - l4*mef*s4) - T_con02*l4*mef*(e3c_s*s4 - l4*s4)*c4)*u1*u3 - (T_con02*(e3c_s*s4 - l4*s4)*(e3c_s*mef*s4 - l4*mef*s4) + l4*mef*(-e3c_s + T_con02*l4*c4)*c4 - l3*mef*(e1c_s - T_con02*l3*c4)*c4)*q4d*u0 - (e1c_s*mef*(-e3c_s + T_con02*l4*c4)*s4 + e3c_s*mef*(e1c_s - T_con02*l3*c4)*s4 + T_con02*e1c_s*mef*(e3c_s*s4 - l4*s4)*c4)*u0*u5 - (T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*c4 - e3c_s*mef*c4) + l4*mef*(-e3c_s + T_con02*l4*c4)*s4 - l3*mef*(e1c_s - T_con02*l3*c4)*s4)*q4d*u1 - (-e1c_s*mef*(-e3c_s + T_con02*l4*c4)*c4 - e3c_s*mef*(e1c_s - T_con02*l3*c4)*c4 + T_con02*e1c_s*mef*(e3c_s*s4 - l4*s4)*s4)*u1*u5 - (T_con02*(e3c_s*s4 - l4*s4)*(l3*mef*s4**2 - l3*mef*c4**2) - 2*e3c_s*mef*(e1c_s - T_con02*l3*c4)*c4*s4 - 2*l3*mef*(-e3c_s + T_con02*l4*c4)*c4*s4)*u0*u1 + IC22*T_con12*u0*u4 + IE13*T_con02*u3d*s4 - T_con02*(ICD33 - ICD11)*u0*u2 - T_con02*(e1c_s*mef - l3*mef)*(e3c_s*s4 - l4*s4)*u3d - T_con12*(ICD11 + ID13 - ID22)*u0*u1 - g*mef*(-e3c_s + T_con02*l4*c4)*(s1*s4 - c1*c4*s3) + g*mcd*(T_con02*l2 - T_con22*rr*c3)*c1*s3 - IF22*T_con02*s4*u3*u5 - T_con02*g*mef*(e3c_s*s4 - l4*s4)*(c4*s1 + c1*s3*s4) - T_con12*g*mcd*(l1 + rr*s3)*s1 - g*mcd*(-T_con02*l1 - T_con22*rr*s3)*c1*c3 - g*mef*(e1c_s - T_con02*l3*c4)*c1*c3 + T_con12*l1*mcd*(l1 + rr*s3)*u0*u1 + T_con12*l2*mcd*(l1 + rr*s3)*u1*u2 - T_con02*e3c_s*mef*(e3c_s*s4 - l4*s4)*u3*u5 + T_con12*mcd*rr*(l1 + rr*s3)*q3d*c3*u2 + T_con12*mcd*rr*(l1 + rr*s3)*s3*u0*u4 - T_con12*mcd*rr*(l1 + rr*s3)*q3d*s3*u0 - T_con12*mcd*rr*(l1 + rr*s3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20) + (_M00*_M22 - _M02*_M20)*(-u0**2*(IE22*c4*s4 - IE13*c4*s4 - IEF11*c4*s4) - u0**2*(-T_con01*l3*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2)*c4 + l3*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4*s4 + T_con01*l3*l4*mef*s4**2*c4) - u1**2*(l1*mcd*(T_con01*l2 - T_con21*rr*c3) + l2*mcd*(-T_con01*l1 - T_con21*rr*s3)) - u1**2*(IE13*c4*s4 + IEF11*c4*s4 - IE22*c4*s4) - u1**2*(-T_con01*l3*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2)*c4 - l3*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4*s4 + T_con01*l3*l4*mef*c4**3) - (-IEF33 - IE13*T_con01*s4)*u3d - (T_con01d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con11*T_con11d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u3 - (T_con02d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con11*T_con12d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u5 - (-ICD33*T_con10d*T_con11 - ID22*T_con00d*T_con01)*u0 - (-ICD33*T_con11*T_con11d - ID22*T_con01*T_con01d)*u3 - (-ICD33*T_con11*T_con12d - ID22*T_con01*T_con02d)*u5 - (T_con00d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con10d*T_con11*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u0 - (mcd*rr*(T_con01*l2 - T_con21*rr*c3)*c3 + mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*s3)*u4d - (T_con01*e1c_s*l3*mef*c4 + T_con01*e3c_s*l4*mef*c4)*u5d + IC22*T_con21*u4d - T_con00d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u0 - T_con00d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u0 - T_con01d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u3 - T_con01d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u3 - T_con02d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u5 - T_con02d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u5 - u0**2*(-T_con01*l1 - T_con21*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(T_con01*l2 - T_con21*rr*c3)*(l1*mcd + mcd*rr*s3) - (e1c_s*mef - l3*mef)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*u3d - ((T_con01*l2 - T_con21*rr*c3)*(-l2*mcd + mcd*rr*c3) + (-T_con01*l1 - T_con21*rr*s3)*(-l1*mcd - mcd*rr*s3))*u0*u2 - (T_con01*(IEF33*c4 - IEF11*c4)*c4 + T_con01*(IE13*s4 + IEF33*s4 - IE22*s4)*s4)*u0*u3 - (T_con01*(IEF33*s4 - IEF11*s4)*c4 + T_con01*(IE22*c4 - IE13*c4 - IEF33*c4)*s4)*u1*u3 - (mcd*rr*(T_con01*l2 - T_con21*rr*c3)*s3 - mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*c3)*u1*u4 - (mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*c3 - mcd*rr*(T_con01*l2 - T_con21*rr*c3)*s3)*q3d*u4 - ((l3*mef*s4**2 - l3*mef*c4**2)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - 2*T_con01*l3*l4*mef*c4**2*s4 + 2*T_con01*e3c_s*l3*mef*c4**2*s4)*u0*u1 - (-IE13*c4 + IE22*T_con01*c4*s4 - IEF11*T_con01*c4*s4)*q4d*u1 - (IE13*s4 + IE22*T_con01*c4**2 + IEF11*T_con01*s4**2)*q4d*u0 - (T_con01*l4*(e3c_s*mef*c4 - l4*mef*c4)*c4 + l4*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*s4 - T_con01*l3*(e1c_s*mef*c4 - l3*mef*c4)*c4)*u0*u3 - (T_con01*l4*(e3c_s*mef*s4 - l4*mef*s4)*c4 - T_con01*l3*(e1c_s*mef*s4 - l3*mef*s4)*c4 - l4*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4)*u1*u3 - ((e3c_s*mef*s4 - l4*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + T_con01*mef*l3**2*c4**2 + T_con01*mef*l4**2*c4**2)*q4d*u0 - (e1c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4 + T_con01*e1c_s*l4*mef*c4*s4 - T_con01*e3c_s*l3*mef*c4*s4)*u0*u5 - (e1c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*s4 + T_con01*e3c_s*l3*mef*c4**2 - T_con01*e1c_s*l4*mef*c4**2)*u1*u5 - ((l4*mef*c4 - e3c_s*mef*c4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + T_con01*mef*l3**2*c4*s4 + T_con01*mef*l4**2*c4*s4)*q4d*u1 - (IE13*c4**2 + IE22*s4**2 + IEF11*c4**2 - IE13*s4**2 - IE22*c4**2 - IEF11*s4**2)*u0*u1 + IC22*T_con11*u0*u4 + IF22*c4*u0*u5 + IF22*s4*u1*u5 - T_con01*(ICD33 - ICD11)*u0*u2 - T_con11*(ICD11 + ID13 - ID22)*u0*u1 - g*mef*(c4*s1 + c1*s3*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + g*mcd*(T_con01*l2 - T_con21*rr*c3)*c1*s3 - IF22*T_con01*s4*u3*u5 - T_con01*l4*u3**2*(l3*mef - e1c_s*mef)*c4 - T_con11*g*mcd*(l1 + rr*s3)*s1 - e3c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*u3*u5 - g*mcd*(-T_con01*l1 - T_con21*rr*s3)*c1*c3 + T_con11*l1*mcd*(l1 + rr*s3)*u0*u1 + T_con11*l2*mcd*(l1 + rr*s3)*u1*u2 - T_con01*g*l4*mef*(s1*s4 - c1*c4*s3)*c4 + T_con01*g*l3*mef*c1*c3*c4 + T_con11*mcd*rr*(l1 + rr*s3)*q3d*c3*u2 + T_con11*mcd*rr*(l1 + rr*s3)*s3*u0*u4 - T_con11*mcd*rr*(l1 + rr*s3)*q3d*s3*u0 - T_con11*mcd*rr*(l1 + rr*s3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20) + (_M12*_M20 - _M10*_M22)*(-u0**2*((l3*s4 - T_con00*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2) + l3*mef*s4**2*(-l4*s4 + T_con00*l4*c4) + l3*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4*s4) - u1**2*(l1*mcd*(T_con00*l2 - T_con20*rr*c3) + l2*mcd*(-T_con00*l1 - T_con20*rr*s3)) - u1**2*((l3*s4 - T_con00*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2) + l3*mef*c4**2*(-l4*s4 + T_con00*l4*c4) - l3*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4*s4) - (T_con00d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con10d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u0 - (T_con02d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con12d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u5 - (T_con01d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con11d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u3 - (T_con10d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con00d)*u0 - (T_con11d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con01d)*u3 - (T_con12d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con02d)*u5 - (e3c_s*mef*(-l4*s4 + T_con00*l4*c4) - e1c_s*mef*(l3*s4 - T_con00*l3*c4))*u5d - (mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*s3 + mcd*rr*(T_con00*l2 - T_con20*rr*c3)*c3)*u4d + IC22*T_con20*u4d + IE13*(T_con00*s4 + c4)*u3d - IC22*u2*u4 - T_con00d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u0 - T_con00d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u0 - T_con01d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u3 - T_con01d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u3 - T_con02d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u5 - T_con02d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u5 - u0**2*(-T_con00*l1 - T_con20*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(l1*mcd + mcd*rr*s3)*(T_con00*l2 - T_con20*rr*c3) - u3**2*(l3*mef - e1c_s*mef)*(-l4*s4 + T_con00*l4*c4) - (e1c_s*mef - l3*mef)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*u3d - ((-s4 + T_con00*c4)*(IEF33*c4 - IEF11*c4) + (T_con00*s4 + c4)*(IE13*s4 + IEF33*s4 - IE22*s4))*u0*u3 - ((IEF33*s4 - IEF11*s4)*(-s4 + T_con00*c4) + (T_con00*s4 + c4)*(IE22*c4 - IE13*c4 - IEF33*c4))*u1*u3 - ((-T_con00*l1 - T_con20*rr*s3)*(-l1*mcd - mcd*rr*s3) + (-l2*mcd + mcd*rr*c3)*(T_con00*l2 - T_con20*rr*c3))*u0*u2 - (IE22*(-s4 + T_con00*c4)*c4 + IEF11*(T_con00*s4 + c4)*s4)*q4d*u0 - (IE22*(-s4 + T_con00*c4)*s4 - IEF11*(T_con00*s4 + c4)*c4)*q4d*u1 - (mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*c3 - mcd*rr*(T_con00*l2 - T_con20*rr*c3)*s3)*q3d*u4 - (mcd*rr*(T_con00*l2 - T_con20*rr*c3)*s3 - mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*c3)*u1*u4 - (ID22 - ICD33 - ID13)*u1*u2 - ((-l4*s4 + T_con00*l4*c4)*(e3c_s*mef*c4 - l4*mef*c4) + (e1c_s*mef*c4 - l3*mef*c4)*(l3*s4 - T_con00*l3*c4) + l4*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*s4)*u0*u3 - ((-l4*s4 + T_con00*l4*c4)*(e3c_s*mef*s4 - l4*mef*s4) + (e1c_s*mef*s4 - l3*mef*s4)*(l3*s4 - T_con00*l3*c4) - l4*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4)*u1*u3 - ((l3*mef*s4**2 - l3*mef*c4**2)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) - 2*e3c_s*mef*(l3*s4 - T_con00*l3*c4)*c4*s4 - 2*l3*mef*(-l4*s4 + T_con00*l4*c4)*c4*s4)*u0*u1 - ((e3c_s*mef*s4 - l4*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l4*mef*(-l4*s4 + T_con00*l4*c4)*c4 - l3*mef*(l3*s4 - T_con00*l3*c4)*c4)*q4d*u0 - (e1c_s*mef*(-l4*s4 + T_con00*l4*c4)*s4 + e1c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4 + e3c_s*mef*(l3*s4 - T_con00*l3*c4)*s4)*u0*u5 - (e1c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*s4 - e1c_s*mef*(-l4*s4 + T_con00*l4*c4)*c4 - e3c_s*mef*(l3*s4 - T_con00*l3*c4)*c4)*u1*u5 - ((l4*mef*c4 - e3c_s*mef*c4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l4*mef*(-l4*s4 + T_con00*l4*c4)*s4 - l3*mef*(l3*s4 - T_con00*l3*c4)*s4)*q4d*u1 + IC22*T_con10*u0*u4 - IF22*(T_con00*s4 + c4)*u3*u5 - T_con00*(ICD33 - ICD11)*u0*u2 - T_con10*(ICD11 + ID13 - ID22)*u0*u1 - g*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*s1 - g*mef*(s1*s4 - c1*c4*s3)*(-l4*s4 + T_con00*l4*c4) - g*mef*(c4*s1 + c1*s3*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + g*mcd*(T_con00*l2 - T_con20*rr*c3)*c1*s3 + l1*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*u0*u1 + l2*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*u1*u2 - e3c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*u3*u5 - g*mcd*(-T_con00*l1 - T_con20*rr*s3)*c1*c3 - g*mef*(l3*s4 - T_con00*l3*c4)*c1*c3 + mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*q3d*c3*u2 + mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*s3*u0*u4 - mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*q3d*s3*u0 - mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20)
    u5d = (_M00*_M11 - _M01*_M10)*(IF22*u5d - u0**2*((e1c_s - T_con02*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2) + l3*mef*s4**2*(-e3c_s + T_con02*l4*c4) + T_con02*l3*mef*(e3c_s*s4 - l4*s4)*c4*s4) - u1**2*(l1*mcd*(T_con02*l2 - T_con22*rr*c3) + l2*mcd*(-T_con02*l1 - T_con22*rr*s3)) - u1**2*((e1c_s - T_con02*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2) + l3*mef*c4**2*(-e3c_s + T_con02*l4*c4) - T_con02*l3*mef*(e3c_s*s4 - l4*s4)*c4*s4) - (T_con00d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con10d*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u0 - (T_con01d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con11d*T_con12*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u3 - (T_con02d*(l1*mcd*(-T_con02*l1 - T_con22*rr*s3) - l2*mcd*(T_con02*l2 - T_con22*rr*c3)) + T_con12*T_con12d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u5 - (-ICD33*T_con10d*T_con12 - ID22*T_con00d*T_con02)*u0 - (-ICD33*T_con11d*T_con12 - ID22*T_con01d*T_con02)*u3 - (-ICD33*T_con12*T_con12d - ID22*T_con02*T_con02d)*u5 - (e3c_s*mef*(-e3c_s + T_con02*l4*c4) - e1c_s*mef*(e1c_s - T_con02*l3*c4))*u5d - (mcd*rr*(T_con02*l2 - T_con22*rr*c3)*c3 + mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*s3)*u4d + IC22*T_con22*u4d - T_con00d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u0 - T_con00d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u0 - T_con01d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u3 - T_con01d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u3 - T_con02d*(-IE22*T_con02*c4**2 - IEF11*T_con02*s4**2)*u5 - T_con02d*(T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*s4 - e3c_s*mef*s4) + l3*mef*(e1c_s - T_con02*l3*c4)*c4 - l4*mef*(-e3c_s + T_con02*l4*c4)*c4)*u5 - u0**2*(-T_con02*l1 - T_con22*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(T_con02*l2 - T_con22*rr*c3)*(l1*mcd + mcd*rr*s3) - u3**2*(-e3c_s + T_con02*l4*c4)*(l3*mef - e1c_s*mef) - ((T_con02*l2 - T_con22*rr*c3)*(-l2*mcd + mcd*rr*c3) + (-T_con02*l1 - T_con22*rr*s3)*(-l1*mcd - mcd*rr*s3))*u0*u2 - (IE22*T_con02*c4**2 + IEF11*T_con02*s4**2)*q4d*u0 - (T_con02*(IEF33*c4 - IEF11*c4)*c4 + T_con02*(IE13*s4 + IEF33*s4 - IE22*s4)*s4)*u0*u3 - (T_con02*(IEF33*s4 - IEF11*s4)*c4 + T_con02*(IE22*c4 - IE13*c4 - IEF33*c4)*s4)*u1*u3 - (IE22*T_con02*c4*s4 - IEF11*T_con02*c4*s4)*q4d*u1 - (mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*c3 - mcd*rr*(T_con02*l2 - T_con22*rr*c3)*s3)*q3d*u4 - (mcd*rr*(T_con02*l2 - T_con22*rr*c3)*s3 - mcd*rr*(-T_con02*l1 - T_con22*rr*s3)*c3)*u1*u4 - ((e1c_s - T_con02*l3*c4)*(e1c_s*mef*c4 - l3*mef*c4) + (-e3c_s + T_con02*l4*c4)*(e3c_s*mef*c4 - l4*mef*c4) + T_con02*l4*mef*(e3c_s*s4 - l4*s4)*s4)*u0*u3 - ((e1c_s - T_con02*l3*c4)*(e1c_s*mef*s4 - l3*mef*s4) + (-e3c_s + T_con02*l4*c4)*(e3c_s*mef*s4 - l4*mef*s4) - T_con02*l4*mef*(e3c_s*s4 - l4*s4)*c4)*u1*u3 - (T_con02*(e3c_s*s4 - l4*s4)*(e3c_s*mef*s4 - l4*mef*s4) + l4*mef*(-e3c_s + T_con02*l4*c4)*c4 - l3*mef*(e1c_s - T_con02*l3*c4)*c4)*q4d*u0 - (e1c_s*mef*(-e3c_s + T_con02*l4*c4)*s4 + e3c_s*mef*(e1c_s - T_con02*l3*c4)*s4 + T_con02*e1c_s*mef*(e3c_s*s4 - l4*s4)*c4)*u0*u5 - (T_con02*(e3c_s*s4 - l4*s4)*(l4*mef*c4 - e3c_s*mef*c4) + l4*mef*(-e3c_s + T_con02*l4*c4)*s4 - l3*mef*(e1c_s - T_con02*l3*c4)*s4)*q4d*u1 - (-e1c_s*mef*(-e3c_s + T_con02*l4*c4)*c4 - e3c_s*mef*(e1c_s - T_con02*l3*c4)*c4 + T_con02*e1c_s*mef*(e3c_s*s4 - l4*s4)*s4)*u1*u5 - (T_con02*(e3c_s*s4 - l4*s4)*(l3*mef*s4**2 - l3*mef*c4**2) - 2*e3c_s*mef*(e1c_s - T_con02*l3*c4)*c4*s4 - 2*l3*mef*(-e3c_s + T_con02*l4*c4)*c4*s4)*u0*u1 + IC22*T_con12*u0*u4 + IE13*T_con02*u3d*s4 - T_con02*(ICD33 - ICD11)*u0*u2 - T_con02*(e1c_s*mef - l3*mef)*(e3c_s*s4 - l4*s4)*u3d - T_con12*(ICD11 + ID13 - ID22)*u0*u1 - g*mef*(-e3c_s + T_con02*l4*c4)*(s1*s4 - c1*c4*s3) + g*mcd*(T_con02*l2 - T_con22*rr*c3)*c1*s3 - IF22*T_con02*s4*u3*u5 - T_con02*g*mef*(e3c_s*s4 - l4*s4)*(c4*s1 + c1*s3*s4) - T_con12*g*mcd*(l1 + rr*s3)*s1 - g*mcd*(-T_con02*l1 - T_con22*rr*s3)*c1*c3 - g*mef*(e1c_s - T_con02*l3*c4)*c1*c3 + T_con12*l1*mcd*(l1 + rr*s3)*u0*u1 + T_con12*l2*mcd*(l1 + rr*s3)*u1*u2 - T_con02*e3c_s*mef*(e3c_s*s4 - l4*s4)*u3*u5 + T_con12*mcd*rr*(l1 + rr*s3)*q3d*c3*u2 + T_con12*mcd*rr*(l1 + rr*s3)*s3*u0*u4 - T_con12*mcd*rr*(l1 + rr*s3)*q3d*s3*u0 - T_con12*mcd*rr*(l1 + rr*s3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20) + (_M01*_M20 - _M00*_M21)*(-u0**2*(IE22*c4*s4 - IE13*c4*s4 - IEF11*c4*s4) - u0**2*(-T_con01*l3*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2)*c4 + l3*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4*s4 + T_con01*l3*l4*mef*s4**2*c4) - u1**2*(l1*mcd*(T_con01*l2 - T_con21*rr*c3) + l2*mcd*(-T_con01*l1 - T_con21*rr*s3)) - u1**2*(IE13*c4*s4 + IEF11*c4*s4 - IE22*c4*s4) - u1**2*(-T_con01*l3*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2)*c4 - l3*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4*s4 + T_con01*l3*l4*mef*c4**3) - (-IEF33 - IE13*T_con01*s4)*u3d - (T_con01d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con11*T_con11d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u3 - (T_con02d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con11*T_con12d*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u5 - (-ICD33*T_con10d*T_con11 - ID22*T_con00d*T_con01)*u0 - (-ICD33*T_con11*T_con11d - ID22*T_con01*T_con01d)*u3 - (-ICD33*T_con11*T_con12d - ID22*T_con01*T_con02d)*u5 - (T_con00d*(l1*mcd*(-T_con01*l1 - T_con21*rr*s3) - l2*mcd*(T_con01*l2 - T_con21*rr*c3)) + T_con10d*T_con11*(l1 + rr*s3)*(-l1*mcd - mcd*rr*s3))*u0 - (mcd*rr*(T_con01*l2 - T_con21*rr*c3)*c3 + mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*s3)*u4d - (T_con01*e1c_s*l3*mef*c4 + T_con01*e3c_s*l4*mef*c4)*u5d + IC22*T_con21*u4d - T_con00d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u0 - T_con00d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u0 - T_con01d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u3 - T_con01d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u3 - T_con02d*((l4*mef*s4 - e3c_s*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - T_con01*mef*l3**2*c4**2 - T_con01*mef*l4**2*c4**2)*u5 - T_con02d*(-IE13*s4 - IE22*T_con01*c4**2 - IEF11*T_con01*s4**2)*u5 - u0**2*(-T_con01*l1 - T_con21*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(T_con01*l2 - T_con21*rr*c3)*(l1*mcd + mcd*rr*s3) - (e1c_s*mef - l3*mef)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*u3d - ((T_con01*l2 - T_con21*rr*c3)*(-l2*mcd + mcd*rr*c3) + (-T_con01*l1 - T_con21*rr*s3)*(-l1*mcd - mcd*rr*s3))*u0*u2 - (T_con01*(IEF33*c4 - IEF11*c4)*c4 + T_con01*(IE13*s4 + IEF33*s4 - IE22*s4)*s4)*u0*u3 - (T_con01*(IEF33*s4 - IEF11*s4)*c4 + T_con01*(IE22*c4 - IE13*c4 - IEF33*c4)*s4)*u1*u3 - (mcd*rr*(T_con01*l2 - T_con21*rr*c3)*s3 - mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*c3)*u1*u4 - (mcd*rr*(-T_con01*l1 - T_con21*rr*s3)*c3 - mcd*rr*(T_con01*l2 - T_con21*rr*c3)*s3)*q3d*u4 - ((l3*mef*s4**2 - l3*mef*c4**2)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) - 2*T_con01*l3*l4*mef*c4**2*s4 + 2*T_con01*e3c_s*l3*mef*c4**2*s4)*u0*u1 - (-IE13*c4 + IE22*T_con01*c4*s4 - IEF11*T_con01*c4*s4)*q4d*u1 - (IE13*s4 + IE22*T_con01*c4**2 + IEF11*T_con01*s4**2)*q4d*u0 - (T_con01*l4*(e3c_s*mef*c4 - l4*mef*c4)*c4 + l4*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*s4 - T_con01*l3*(e1c_s*mef*c4 - l3*mef*c4)*c4)*u0*u3 - (T_con01*l4*(e3c_s*mef*s4 - l4*mef*s4)*c4 - T_con01*l3*(e1c_s*mef*s4 - l3*mef*s4)*c4 - l4*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4)*u1*u3 - ((e3c_s*mef*s4 - l4*mef*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + T_con01*mef*l3**2*c4**2 + T_con01*mef*l4**2*c4**2)*q4d*u0 - (e1c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*c4 + T_con01*e1c_s*l4*mef*c4*s4 - T_con01*e3c_s*l3*mef*c4*s4)*u0*u5 - (e1c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*s4 + T_con01*e3c_s*l3*mef*c4**2 - T_con01*e1c_s*l4*mef*c4**2)*u1*u5 - ((l4*mef*c4 - e3c_s*mef*c4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + T_con01*mef*l3**2*c4*s4 + T_con01*mef*l4**2*c4*s4)*q4d*u1 - (IE13*c4**2 + IE22*s4**2 + IEF11*c4**2 - IE13*s4**2 - IE22*c4**2 - IEF11*s4**2)*u0*u1 + IC22*T_con11*u0*u4 + IF22*c4*u0*u5 + IF22*s4*u1*u5 - T_con01*(ICD33 - ICD11)*u0*u2 - T_con11*(ICD11 + ID13 - ID22)*u0*u1 - g*mef*(c4*s1 + c1*s3*s4)*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4)) + g*mcd*(T_con01*l2 - T_con21*rr*c3)*c1*s3 - IF22*T_con01*s4*u3*u5 - T_con01*l4*u3**2*(l3*mef - e1c_s*mef)*c4 - T_con11*g*mcd*(l1 + rr*s3)*s1 - e3c_s*mef*(l3 - e1c_s + T_con01*(e3c_s*s4 - l4*s4))*u3*u5 - g*mcd*(-T_con01*l1 - T_con21*rr*s3)*c1*c3 + T_con11*l1*mcd*(l1 + rr*s3)*u0*u1 + T_con11*l2*mcd*(l1 + rr*s3)*u1*u2 - T_con01*g*l4*mef*(s1*s4 - c1*c4*s3)*c4 + T_con01*g*l3*mef*c1*c3*c4 + T_con11*mcd*rr*(l1 + rr*s3)*q3d*c3*u2 + T_con11*mcd*rr*(l1 + rr*s3)*s3*u0*u4 - T_con11*mcd*rr*(l1 + rr*s3)*q3d*s3*u0 - T_con11*mcd*rr*(l1 + rr*s3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20) + (_M10*_M21 - _M11*_M20)*(-u0**2*((l3*s4 - T_con00*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*c4**2) + l3*mef*s4**2*(-l4*s4 + T_con00*l4*c4) + l3*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4*s4) - u1**2*(l1*mcd*(T_con00*l2 - T_con20*rr*c3) + l2*mcd*(-T_con00*l1 - T_con20*rr*s3)) - u1**2*((l3*s4 - T_con00*l3*c4)*(l4*mef*c4**2 + l4*mef*s4**2 - e3c_s*mef*s4**2) + l3*mef*c4**2*(-l4*s4 + T_con00*l4*c4) - l3*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4*s4) - (T_con00d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con10d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u0 - (T_con02d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con12d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u5 - (T_con01d*(l1*mcd*(-T_con00*l1 - T_con20*rr*s3) - l2*mcd*(T_con00*l2 - T_con20*rr*c3)) + T_con11d*(-l1*mcd - mcd*rr*s3)*(-l2 + T_con10*(l1 + rr*s3) + rr*c3))*u3 - (T_con10d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con00d)*u0 - (T_con11d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con01d)*u3 - (T_con12d*(-ID13 - ICD33*T_con10) - ID22*T_con00*T_con02d)*u5 - (e3c_s*mef*(-l4*s4 + T_con00*l4*c4) - e1c_s*mef*(l3*s4 - T_con00*l3*c4))*u5d - (mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*s3 + mcd*rr*(T_con00*l2 - T_con20*rr*c3)*c3)*u4d + IC22*T_con20*u4d + IE13*(T_con00*s4 + c4)*u3d - IC22*u2*u4 - T_con00d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u0 - T_con00d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u0 - T_con01d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u3 - T_con01d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u3 - T_con02d*(-IE22*(-s4 + T_con00*c4)*c4 - IEF11*(T_con00*s4 + c4)*s4)*u5 - T_con02d*((l4*mef*s4 - e3c_s*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l3*mef*(l3*s4 - T_con00*l3*c4)*c4 - l4*mef*(-l4*s4 + T_con00*l4*c4)*c4)*u5 - u0**2*(-T_con00*l1 - T_con20*rr*s3)*(l2*mcd - mcd*rr*c3) - u2**2*(l1*mcd + mcd*rr*s3)*(T_con00*l2 - T_con20*rr*c3) - u3**2*(l3*mef - e1c_s*mef)*(-l4*s4 + T_con00*l4*c4) - (e1c_s*mef - l3*mef)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*u3d - ((-s4 + T_con00*c4)*(IEF33*c4 - IEF11*c4) + (T_con00*s4 + c4)*(IE13*s4 + IEF33*s4 - IE22*s4))*u0*u3 - ((IEF33*s4 - IEF11*s4)*(-s4 + T_con00*c4) + (T_con00*s4 + c4)*(IE22*c4 - IE13*c4 - IEF33*c4))*u1*u3 - ((-T_con00*l1 - T_con20*rr*s3)*(-l1*mcd - mcd*rr*s3) + (-l2*mcd + mcd*rr*c3)*(T_con00*l2 - T_con20*rr*c3))*u0*u2 - (IE22*(-s4 + T_con00*c4)*c4 + IEF11*(T_con00*s4 + c4)*s4)*q4d*u0 - (IE22*(-s4 + T_con00*c4)*s4 - IEF11*(T_con00*s4 + c4)*c4)*q4d*u1 - (mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*c3 - mcd*rr*(T_con00*l2 - T_con20*rr*c3)*s3)*q3d*u4 - (mcd*rr*(T_con00*l2 - T_con20*rr*c3)*s3 - mcd*rr*(-T_con00*l1 - T_con20*rr*s3)*c3)*u1*u4 - (ID22 - ICD33 - ID13)*u1*u2 - ((-l4*s4 + T_con00*l4*c4)*(e3c_s*mef*c4 - l4*mef*c4) + (e1c_s*mef*c4 - l3*mef*c4)*(l3*s4 - T_con00*l3*c4) + l4*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*s4)*u0*u3 - ((-l4*s4 + T_con00*l4*c4)*(e3c_s*mef*s4 - l4*mef*s4) + (e1c_s*mef*s4 - l3*mef*s4)*(l3*s4 - T_con00*l3*c4) - l4*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4)*u1*u3 - ((l3*mef*s4**2 - l3*mef*c4**2)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) - 2*e3c_s*mef*(l3*s4 - T_con00*l3*c4)*c4*s4 - 2*l3*mef*(-l4*s4 + T_con00*l4*c4)*c4*s4)*u0*u1 - ((e3c_s*mef*s4 - l4*mef*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l4*mef*(-l4*s4 + T_con00*l4*c4)*c4 - l3*mef*(l3*s4 - T_con00*l3*c4)*c4)*q4d*u0 - (e1c_s*mef*(-l4*s4 + T_con00*l4*c4)*s4 + e1c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*c4 + e3c_s*mef*(l3*s4 - T_con00*l3*c4)*s4)*u0*u5 - (e1c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*s4 - e1c_s*mef*(-l4*s4 + T_con00*l4*c4)*c4 - e3c_s*mef*(l3*s4 - T_con00*l3*c4)*c4)*u1*u5 - ((l4*mef*c4 - e3c_s*mef*c4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + l4*mef*(-l4*s4 + T_con00*l4*c4)*s4 - l3*mef*(l3*s4 - T_con00*l3*c4)*s4)*q4d*u1 + IC22*T_con10*u0*u4 - IF22*(T_con00*s4 + c4)*u3*u5 - T_con00*(ICD33 - ICD11)*u0*u2 - T_con10*(ICD11 + ID13 - ID22)*u0*u1 - g*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*s1 - g*mef*(s1*s4 - c1*c4*s3)*(-l4*s4 + T_con00*l4*c4) - g*mef*(c4*s1 + c1*s3*s4)*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4) + g*mcd*(T_con00*l2 - T_con20*rr*c3)*c1*s3 + l1*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*u0*u1 + l2*mcd*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*u1*u2 - e3c_s*mef*(T_con00*(e3c_s*s4 - l4*s4) + e3c_s*c4 - l4*c4)*u3*u5 - g*mcd*(-T_con00*l1 - T_con20*rr*s3)*c1*c3 - g*mef*(l3*s4 - T_con00*l3*c4)*c1*c3 + mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*q3d*c3*u2 + mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*s3*u0*u4 - mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*q3d*s3*u0 - mcd*rr*(-l2 + T_con10*(l1 + rr*s3) + rr*c3)*c3*u2*u4)/(_M00*_M11*_M22 + _M01*_M12*_M20 + _M02*_M10*_M21 - _M00*_M12*_M21 - _M01*_M10*_M22 - _M02*_M11*_M20)

    # Return calculated values
    return [q0d, q1d, q2d, q3d, q4d, q5d, q6d, q7d, u0d, u3d, u5d]

mj_params = {"w": 1.02, "c": 0.08, "lambda": pi/10., "g":9.81, "rr": 0.3, "mr": 2.0, "IRxx": 0.0603, "IRyy": 0.12, "xb": 0.3, "zb":-0.9, "mb": 85.0, "IBxx": 9.2, "IBxz": 2.4, "IByy": 11.0, "IBzz": 2.8, "xh":0.9, "zh": -0.7, "mh": 4.0, "IHxx": 0.05892, "IHxz": -0.00756, "IHyy": 0.06,"IHzz": 0.00708, "rf": 0.35, "mf": 3.0, "IFxx": 0.1405, "IFyy": 0.28}
