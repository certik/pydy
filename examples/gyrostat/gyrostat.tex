\documentclass[letterpaper,11pt]{article}
\usepackage[margin=1in,centering]{geometry}
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\newcommand{\bs}[1]{ \boldsymbol{ #1 } }
\newcommand{\ud}{\mathrm{d}}
\pagestyle{fancy}
\fancyhead[L]{Gyrostat equations of motion, Dale L. Peterson}
\fancyhead[R]{\today}  % page number on the right
\fancyfoot[L,R]{}  %  No footer on left, center or right, on even or odd pages
\fancyfoot[C]{\thepage}
\begin{document}
\begin{abstract}

  Equations of motion for a gyrostat comprised of two rigid bodies (a carrier
  with a lateral plane of symmetry and an axially symmetric a rotor) are
  derived in two different ways.  In the first approach, each rigid body is
  treated separately as each having their own mass and inertia.  In the second
  approach, the symmetry of the rotor is used to combine the inertias in such a
  way that simplifies the derivation of the equations of motion.  It is shown
  that the two approaches are equivalent.

\end{abstract}

\section*{Model Description}
Consider a rigid body $A$, of mass $m_a$, along with a dextral set of unit
vectors $\bs{a}_1$, $\bs{a}_2$, $\bs{a}_3$, fixed to $A$, with $\bs{a}_3
\triangleq \bs{a}_1 \times \bs{a}_2$.  Let $A^*$ denote the center of mass of
$A$.  Let the inertia dyadic of $A$ relative to its mass center $A^*$ be:
\begin{align*}
  \bs{I}^{A/A^*} & = I_{11}\bs{a}_1\bs{a}_1 + I_{22}\bs{a}_2\bs{a}_2 +
  I_{33}\bs{a}_3\bs{a}_3 + I_{13}\bs{a}_1\bs{a}_3 + I_{13}\bs{a}_3\bs{a}_1
\end{align*}
The plane spanned by the $\bs{a}_1$ and $\bs{a}_3$ unit vectors is a plane of
symmetry.

Consider a second rigid body $B$, of mass $m_b$, along with a dextral set of
unit vectors $\bs{b}_1$, $\bs{b}_2$, $\bs{b}_3$, fixed to $B$, with $\bs{b}_3
\triangleq \bs{b}_1 \times \bs{b}_2$.  Let $B^*$ denote the center of mass of
$B$.  Let the inertia dyadic of $B$ relative to its mass center  $B^*$ be:
\begin{align*}
  \bs{I}^{B/B^*} & = I\bs{b}_1\bs{b}_1 + J\bs{b}_2\bs{b}_2 + I\bs{b}_3\bs{b}_3
\end{align*}
$B$ is axially symmetric about the $\bs{b}_2$ axis.

Let $B$ be rigidly fixed to $A$ such that the mass center $B^*$ is located in
the plane of symmetry of $A$ so that:
\begin{align*}
  \bs{r}^{B^* / A^*} & = l_1 \bs{a}_1 + l_3 \bs{a}_3
\end{align*}
where $l_1, l_3$ are real constants.

Denote the center of mass of the system as $AB^*$. The position of $A^*$ and
$B^*$ relative to the system mass center $AB^*$ is:
\begin{align*}
  \bs{r}^{A^* / AB^*} & = -\frac{m_b}{m_a+m_b}(l_1 \bs{a}_1 + l_3 \bs{a}_3) \\
  \bs{r}^{B^* / AB^*} & =  \frac{m_a}{m_a+m_b}(l_1 \bs{a}_1 + l_3 \bs{a}_3)
\end{align*}

$B$ is oriented relative to $A$ by means of a revolute joint whose axis is
aligned with $\bs{a}_2$ and passes through $B^*$.  Because of the inertial
symmetry of the rotor, the central inertia dyadic of $B$ can be expressed
equivalently in the $A$ frame:
\begin{align*}
  \bs{I}^{B/B^*} & = I\bs{a}_1\bs{a}_1 + J\bs{a}_2\bs{a}_2 + I\bs{a}_3\bs{a}_3
\end{align*}

A couple of torque $T$ is applied between $A$ and $B$ about the axis of
rotation $\bs{a}_2$.  If $A$ were held fixed, a positive torque $T$ would cause
$B$ to rotate relative to $A$ in a counterclockwise direction about the
$\bs{a}_2$ axis.

\section*{Equations of motion}
\subsection*{Kinematics}

The system is completely described by seven generalized coordinates: three
which locate the system in inertial space, three which orient $A$ in inertial
space, and one which orients $B$ relative to $A$.

The orientation of $A$ relative to the inertial frame $N$ is given by a
sequence of rotations ($q_1$, $q_2$, $q_3$) 3-1-2 Euler angles.  The direction
cosine matrix relating the unit vectors fixed in $N$ and $A$ is shown in Table
\ref{directioncosines}.

\begin{table}[!h]
  \begin{center}
    \begin{tabular}{l|ccc}
      & $\bs{a}_1$ & $\bs{a}_2$ & $\bs{a}_3$ \\
      \hline
      $\bs{n}_1$ & $c_1c_3 - s_1s_2s_3$ & $-s_1c_2$ & $c_1s_3 + c_3s_1s_2$ \\
      $\bs{n}_2$ & $s_1c_3 + c_1s_2s_3$ & $ c_1c_2$& $s_1s_3 - c_1c_3s_2$ \\
      $\bs{n}_3$ & $-c_2s_3$ & $s_2$& $c_2c_3$
    \end{tabular}
  \end{center}
  \caption{Direction cosine matrix relating unit vectors of $A$ and $N$}
  \label{directioncosines}
\end{table}

$B$ is oriented relative to $A$ by first aligning $\bs{b}_i$ with $\bs{a}_i
\:\: (i = 1,2,3)$ then performing a right handed rotation of $B$ by an angle
$q_4$ about the $\bs{a}_2$ axis.

Let the mass center $AB^*$ be located relative to the inertial origin $N^*$ by:
\begin{align*}
  \bs{r}^{AB^*/N^*} & = q_5 \bs{n}_1 + q_6 \bs{n}_2 + q_7 \bs{n}_3
\end{align*}

For sake of symbolic brevity, introduce the following terms:
\begin{align*}
  l_{1a} & = -\frac{l_1 m_b}{m_a + m_b} &
  l_{3a} & = -\frac{l_3 m_b}{m_a + m_b} \\
  l_{1b} & = \frac{l_1 m_a}{m_a + m_b} &
  l_{3b} & = \frac{l_3 m_a}{m_a + m_b}
\end{align*}

Let $\bs{\omega}^A$ and $\bs{\omega}^B$ denote the angular velocity of $A$ and $B$
relative to the inertial frame, respectively.  Let $\bs{v}^{A^*}$,
$\bs{v}^{B^*}$, and $\bs{v}^{AB^*}$ denote the
velocity of $A^*$, $B^*$, and $AB^*$ relative to the inertial frame,
respectively.  Define the following generalized speeds:
\begin{align}
  u_i & \triangleq \bs{\omega}^A \cdot \bs{a}_i  \qquad  (i = 1,2,3)
  \label{u_defs1} \\
  u_4 & \triangleq \bs{\omega}^B \cdot \bs{a}_2 \label{u_defs2} \\
  u_i & \triangleq \bs{v}^{AB^*} \cdot \bs{n}_{i-4} \qquad  (i = 5,6,7)
  \label{u_defs3}
\end{align}
The above generalized speeds result in the following angular velocities and
velocities:
\begin{align*}
  \bs{\omega}^A & = u_1 \bs{a}_1 + u_2 \bs{a}_2 + u_3 \bs{a}_3 \\
  \bs{\omega}^B & = u_1 \bs{a}_1 + u_4 \bs{a}_2 + u_3 \bs{a}_3 \\
  \bs{v}^{AB^*} & = u_5 \bs{n}_1 + u_6 \bs{n}_2 + u_7 \bs{n}_3 \\
  \bs{v}^{A^*}  & = \bs{v}^{AB^*} + \bs{\omega}^A \times \bs{r}^{A^*/AB^*} \\
  & = u_5 \bs{n}_1 + u_6 \bs{n}_2 + u_7 \bs{n}_3 +l_{3a}u_2\bs{a}_1 +
  (l_{1a}u_3 - l_{3a}u_1)\bs{a}_2 - l_{1a}u_2\bs{a}_3 \\
  \bs{v}^{B^*}  & = \bs{v}^{AB^*} + \bs{\omega}^A \times \bs{r}^{B^*/AB^*} \\
  & = u_5 \bs{n}_1 + u_6 \bs{n}_2 + u_7 \bs{n}_3 +l_{3b}u_2\bs{a}_1 +
  (l_{1b}u_3 - l_{3b}u_1)\bs{a}_2 - l_{1b}u_2\bs{a}_3
\end{align*}

All of the above velocities are relative to the inertial frame, and of
particular interest here is that the angular velocity expressions for $A$ and
$B$ only in their $\bs{a}_2$ component, which is the axis of rotation of
$B$ relative to $A$.

By inspection of the angular velocity expressions for $A$ and $B$, and the
velocity expressions for $A^*$ and $B^*$, the partial angular velocities and
partial velocities can be determined.  They are simply the vector coefficients
of the generalized speeds, which appear linearly in the velocity and angular
velocity expressions.  They are shown in Table \ref{partialvelocities}.

\begin{table}[!h]
  \begin{center}
    \begin{tabular}{lllllll}
      $\bs{\omega}^A_1 = \bs{a}_1$ & $\bs{\omega}^A_2 = \bs{a}_2$ &
      $\bs{\omega}^A_3 = \bs{a}_3$ & $\bs{\omega}^A_4 = \bs{0}$ &
      $\bs{\omega}^A_5 = \bs{0}$ & $\bs{\omega}^A_6 = \bs{0}$ &
      $\bs{\omega}^A_7 = \bs{0}$ \\
%
      $\bs{\omega}^B_1 = \bs{a}_1$ & $\bs{\omega}^B_2 = \bs{0}$ &
      $\bs{\omega}^B_3 = \bs{a}_3$ & $\bs{\omega}^B_4 = \bs{a}_2$ &
      $\bs{\omega}^B_5 = \bs{0}$ & $\bs{\omega}^B_6 = \bs{0}$ &
      $\bs{\omega}^B_7 = \bs{0}$ \\
%
      $\bs{v}^{AB^*}_1 = \bs{0}$ & $\bs{v}^{AB^*}_2 = \bs{0}$ &
      $\bs{v}^{AB^*}_3 = \bs{0}$ & $\bs{v}^{AB^*}_4 = \bs{0}$ &
      $\bs{v}^{AB^*}_5 = \bs{n}_1$ & $\bs{v}^{AB^*}_6 = \bs{n}_2$ &
      $\bs{v}^{AB^*}_7 = \bs{n}_3$ \\
%
      $\bs{v}^{A^*}_1 = -l_{3a}\bs{a}_2$ &
      $\bs{v}^{A^*}_2 = l_{3a}\bs{a}_1 - l_{1a}\bs{a}_3$ &
      $\bs{v}^{A^*}_3 = l_{1a} \bs{a}_2$ &
      $\bs{v}^{A^*}_4 = \bs{0}$ & $\bs{v}^{A^*}_5 = \bs{n}_1$ & 
      $\bs{v}^{A^*}_6 = \bs{n}_2$ & $\bs{v}^{A^*}_7 = \bs{n}_3$ \\
%
      $\bs{v}^{B^*}_1 = -l_{3b}\bs{a}_2$ &
      $\bs{v}^{B^*}_2 = l_{3b}\bs{a}_1 - l_{1b}\bs{a}_3$ &
      $\bs{v}^{B^*}_3 = l_{1b} \bs{a}_2$ & $\bs{v}^{B^*}_4 = \bs{0}$ &
      $\bs{v}^{B^*}_5 = \bs{n}_1$ & $\bs{v}^{B^*}_6 = \bs{n}_2$ &
      $\bs{v}^{B^*}_7 = \bs{n}_3$
%
    \end{tabular}
  \end{center}
  \caption{Partial angular velocities and partial velocities}
  \label{partialvelocities}
\end{table}

These definitions, along with (\ref{u_defs1}, \ref{u_defs2}, \ref{u_defs3})
yield the following kinematic differential equations:
\begin{align*}
  \dot{q}_1 &=  -s_3u_1/c_2 + c_3u_3/c_2\\
  \dot{q}_2 &=  c_3u_1 + s_3u_3 \\
  \dot{q}_3 &=  t_2s_3u_1 + u_2 - t_2c_3u_3 \\
  \dot{q}_4 &= -u_2 +  u_4 \\
  \dot{q}_5 &= u_5 \\
  \dot{q}_6 &= u_6 \\
  \dot{q}_7 &= u_7
\end{align*}
While these equations are necessary for kinematics, they aren't too interesting
because all the coordinates are ignorable with respect to the dynamic
differential equations.

\subsection*{Dynamics}
There are two contributing forces and torques acting on the system, the first
arising from gravity, the second arising from the applied torque between the
two bodies.
\begin{align*}
  \bs{G}_{A^*} & = m_ag\bs{n}_3 \\
  \bs{G}_{B^*} & = m_bg\bs{n}_3 \\
  \bs{T}_A & = - T \bs{a}_2 \\
  \bs{T}_B & = T \bs{a}_2
\end{align*}

To compute the inertia forces of the system, we need to form the
angular accelerations of $A$ and $B$ as well as accelerations of the points
$AB^*$, $A^*$, and $B^*$. The angular accelerations relative to the inertial
frame are:
\begin{align*}
  \bs{\alpha}^A & = \dot{u}_1 \bs{a}_1 + \dot{u}_2 \bs{a}_2 + \dot{u}_3 \bs{a}_3\\
  \bs{\alpha}^B & =(u_2u_3 - u_3u_4 + \dot{u}_1)\bs{a}_1 + \dot{u}_4\bs{a}_2 + (u_1u_4 -
  u_1u_2 + \dot{u}_3)\bs{a}_3
\end{align*}
The accelerations of $AB^*$, $A^*$, and $B^*$, relative to the inertial
origin are:
\begin{align*}
  \bs{a}^{AB^*} &= \dot{u}_5\bs{n}_1 + \dot{u}_6\bs{n}_2 + \dot{u}_7\bs{n}_3
  \\
  \bs{a}^{A^*} &= \dot{u}_5\bs{n}_1 + \dot{u}_6\bs{n}_2 + \dot{u}_7\bs{n}_3
  + (l_{3a}(\dot{u}_2 + u_1u_3) - l_{1a}(u_2^2 + u_3^2))\bs{a}_1 \\
  &+ (l_{1a}(\dot{u}_3 + u_1u_2) + l_{3a}(u_2u_3 - \dot{u}_1))\bs{a}_2
  - (l_{1a}(\dot{u}_2 + u_1u_3) + l_{3a}(u_1^2 + u_2^2))\bs{a}_3
  \\
  \bs{a}^{B^*} &= \dot{u}_5\bs{n}_1 + \dot{u}_6\bs{n}_2 + \dot{u}_7\bs{n}_3
  + (l_{3b}(\dot{u}_2 + u_1u_3) - l_{1b}(u_2^2 + u_3^2))\bs{a}_1 \\
  &+ (l_{1b}(\dot{u}_3 + u_1u_2) + l_{3b}(u_2u_3 - \dot{u}_1))\bs{a}_2
  - (l_{1b}(\dot{u}_2 + u_1u_3) + l_{3b}(u_1^2 + u_2^2))\bs{a}_3
\end{align*}

The inertia force and inertia torque for the rigid bodies $A$ and $B$ are:
\begin{align*}
  \bs{R}^*_A  =& -m_a \bs{a}^{A^*} \\
  \bs{T}^*_A  =& -\bs{\alpha}^A \cdot \bs{I}^{A/A^*} - \bs{\omega}^A \times
  \bs{I}^{A/A^*} \cdot \bs{\omega}^A \\
  = &-(I_{11}\dot{u}_1 + I_{13}\dot{u}_3)\bs{a}_1 - I_{22}\dot{u}_2\bs{a}_2 -
  (I_{13}\dot{u}_1 + I_{33}\dot{u}_3)\bs{a}_3 \\
   + & (I_{13}u_1u_2 + (I_{33} - I_{22})u_2u_3)\bs{a}_1 +
  (I_{13}u_1^2 + (I_{33}- I_{11})u_1u_3 - I_{13}u_3^2)\bs{a}_2 \\
  + & ((I_{11} - I_{22})u_1u_2 + I_{13}u_2u_3)\bs{a}_3 \\
  \bs{R}^*_B = & -m_b \bs{a}^{B^*} \\
  \bs{T}^*_B = & -\bs{\alpha}^B \cdot \bs{I}^{B/B^*} - \bs{\omega}^B \times
  \bs{I}^{B/B^*} \cdot \bs{\omega}^B \\
  = & -I(u_2u_3 - u_3u_4 + \dot{u}_1)\bs{a}_1 - J\dot{u}_4\bs{a}_2 - I(u_1u_4 - u_1u_2 +
  \dot{u}_3)\bs{a}_3 \\
  + & (Ju_3u_4 - Iu_3u_4)\bs{a}_1 + (Iu_1u_4 - Ju_1u_4)\bs{a}_3 \\
  = &-(I\dot{u}_1 - Ju_3u_4 + Iu_2u_3)\bs{a}_1 - J\dot{u}_4\bs{a}_2 -
  (I\dot{u}_3 + Ju_1u_4 - Iu_1u_2)\bs{a}_3
\end{align*}

Kane's equations of motion can now be written concisely as:
\begin{align*}
  \bs{v}^{A^*}_r \cdot (\bs{G}_{A^*} + \bs{R}^*_A) +
  \bs{v}^{B^*}_r \cdot (\bs{G}_{B^*} + \bs{R}^*_B) +
  \bs{\omega}^A_r \cdot (\bs{T}_A + \bs{T}^*_A) +
  \bs{\omega}^B_r \cdot (\bs{T}_B + \bs{T}^*_B) & = 0
\end{align*}
where $\quad r = 1,\dots,7$.

Explicitly, the first four (orientation related) dynamic differential equations are:
\begin{align*}
  % EOM1 LHS
  -\left(I_{11} + m_al_{3a}^2 + I + m_bl_{3b}^2\right)\dot{u}_{1}
  - \left(I_{13} - m_al_{1a}l_{3a} - m_bl_{1b}l_{3b}\right)\dot{u}_{3}
  & =
  % EOM1 RHS
  (I_{13}  - m_al_{1a}l_{3a} - m_bl_{1b}l_{3b})u_1u_2\\
  + (I_{33} + I - I_{22}& - m_al_{3a}^2 - m_bl_{3b}^2)u_2u_3 - Ju_3u_4
  \\
  % EOM2 LHS
-(I_{22} + m_a(l_{1a}^2 + l_{3a}^2) + m_b(l_{1b}^2 + l_{3b}^2)) \dot{u}_2
  =
  % EOM2 RHS
  T
  -(I_{13} - &m_al_{1a}l_{3a} - m_bl_{1b}l_{3b})u_1^2 \\
  + (I_{13} - m_al_{1a}l_{3a} - m_bl_{1b}l_{3b})u_3^2
  + (I_{11} - I_{33} + &m_a(l_{3a}^2 - l_{1a}^2)
  + m_b(l_{3b} - l_{1b}^2))u_1u_3
  \\
  % EOM3 LHS
  -(I_{13} - m_al_{1a}l_{3a} - m_bl_{1b}l_{3b}) \dot{u}_1 - (I_{33} +
  m_al_{1a}^2 + I + m_bl_{1b}^2) \dot{u}_3
  % EOM3 RHS
  & = Ju_1u_4
  \\
  + (I_{22} - I_{11} + m_al_{1a}^2 - I + m_bl_{1b}^2)u_1u_2 -
  (&I_{13} - m_al_{1a}l_{3a} - m_bl_{1b}l_{3b})u_2u_3
  \\
  % EOM4
  -J\dot{u}_4 &=  -T
\end{align*}

If not for the introduction of the variables $l_{1a}, l_{1b}, l_{3a}$, and
$l_{3b}$, these equations would be significantly longer. As it is, there are a
substantial number of multiply and add operations that need only be done once,
but if the above symbolic expressions were coded (or auto generated) in a
numerical routine verbatim (i.e., for numerical integration), they would be
performed at every time step (and intermediate time steps).  This is a
computationally wasteful approach, and further, the structure of the equations
is clouded by excessively long symbolic expressions.

The three equations of motion associated with translation are:
$\dot{u}_5 = 0$, $\dot{u}_6 = 0$, $\dot{u}_7 = g$.  Although these equations
are trivial and intuitive, the symbolic manipulations required in order for
this simple form to be apparent are substantial when each mass center is treated
individually; when computed symbolically on a computer, these necessary
symbolic cancellations may or may not happen without additional user input.

\subsubsection*{Equivalent formulation}
Consider now $\tilde{A}$ as a rigid body of mass $M$, whose mass center
$\tilde{A}^*$ is coincident with $AB^*$, and additionally has the same angular
orientation as $A$.
Let the central inertia dyadic of $\tilde{A}$ be:
\begin{align*}
  \bs{I}^{\tilde{A}/\tilde{A}^*} & = I_{\tilde{A}11}\bs{a}_1\bs{a}_1 + I_{\tilde{A}22}\bs{a}_2\bs{a}_2 +
  I_{\tilde{A}33}\bs{a}_3\bs{a}_3 + I_{\tilde{A}13}\bs{a}_1\bs{a}_3 + I_{\tilde{A}13}\bs{a}_3\bs{a}_1
\end{align*}

Consider a second rigid body $\tilde{B}$ as massless, yet having a central inertia
dyadic of
\begin{align*}
  \bs{I}^{\tilde{B}/\tilde{B}^*} & = \tilde{J}\bs{a}_2\bs{a}_2
\end{align*}
Additionally, consider the angular orientation of $\tilde{B}$ to be identical
to that of $B$ in the original system.

The active force and torques are:
\begin{align*}
  \bs{G}_{\tilde{A}^*} & = Mg\bs{n}_3 \\
  \bs{T}_{\tilde{A}} & = - T \bs{a}_2 \\
  \bs{T}_{\tilde{B}} & = T \bs{a}_2
\end{align*}

Only one inertia force needs to be computed:
\begin{align*}
  \bs{R}^*_{\tilde{A}} & = -M\bs{a}^{AB^*}\\
  & = -M\left(\dot{u}_5 \bs{n}_1 + \dot{u}_6 \bs{n}_2 + \dot{u}_7
  \bs{n}_3\right)
\end{align*}
The two inertia torques are:
\begin{align*}
  \bs{T}^*_{\tilde{A}} & = - \bs{\alpha}^A \cdot \bs{I}^{\tilde{A}/\tilde{A}^*}
  - \bs{\omega}^A \times \bs{I}^{\tilde{A}/\tilde{A}^*} \cdot \bs{\omega}^A
  \\
  & =
  (-I_{\tilde{A}11}\dot{u}_1 - I_{\tilde{A}13}\dot{u}_3
  - I_{\tilde{A}13}u_1u_2 + (I_{\tilde{A}22} - I_{\tilde{A}33})u_2u_3 )\bs{a}_1
  \\
  & - (I_{\tilde{A}22}\dot{u}_2 + (I_{\tilde{A}11} - I_{\tilde{A}33})u_1u_3
  + I_{\tilde{A}13}u_1^2 - I_{\tilde{A}13}u_3^2)\bs{a}_2
  \\
  & - (I_{\tilde{A}13}\dot{u}_1 + I_{\tilde{A}33}\dot{u}_3 + (I_{\tilde{A}22}
  - I_{\tilde{A}11})u_1u_2 - I_{\tilde{A}13}u_2u_3)\bs{a}_3
  \\
  \bs{T}^*_{\tilde{B}} & = -\bs{\alpha}^B \cdot \bs{I}^{\tilde{B}/\tilde{B}^*}
  - \bs{\omega}^B \times \bs{I}^{\tilde{B}/\tilde{B}^*} \cdot \bs{\omega}^B \\
  & = \tilde{J}(u_3u_4\bs{a}_1 - \dot{u}_4\bs{a}_2 - u_1u_4)\bs{a}_3
\end{align*}

Kane's equations of motions are:
\begin{align*}
  \bs{v}^{AB^*}_r \cdot (\bs{G}_{\tilde{A}} + \bs{R}^*_{\tilde{A}}) +
  \bs{\omega}^A_r \cdot (\bs{T}_{\tilde{A}} + \bs{T}^*_{\tilde{A}}) +
  \bs{\omega}^B_r \cdot (\bs{T}_{\tilde{B}} + \bs{T}^*_{\tilde{B}}) & = \bs{0} \qquad r = 1,\dots,7
\end{align*}
More explicitly, the first four of these equations are:
\begin{align*}
  -I_{\tilde{A}11}\dot{u}_1 - I_{\tilde{A}13}\dot{u}_3 &= I_{\tilde{A}13}u_1u_2
  + (I_{\tilde{A}33} - I_{\tilde{A}22})u_2u_3 - \tilde{J}u_3u_4
  \\
  -I_{\tilde{A}22}\dot{u}_2 &=  T - I_{\tilde{A}13}u_1^2 + I_{\tilde{A}13}u_3^2
  + (I_{\tilde{A}11} - I_{\tilde{A}33})u_1u_3
 \\
 -I_{\tilde{A}13}\dot{u}_1 - I_{\tilde{A}33}\dot{u}_3 & =  \tilde{J}u_1u_4 +
 (I_{\tilde{A}22} - I_{\tilde{A}11})u_1u_2 - I_{\tilde{A}13}u_2u_3
 \\
 -\tilde{J}\dot{u}_4 &= -T
\end{align*}
It is important to note that the form of these equations are identical to the
previous formulation, and that the only difference is the coefficients of the
$\dot{u}_i$ terms and the $u_iu_j$ terms.  From a symbolic computation point of
view, these equations are {\it{much}} easier to obtain because all of the dot
products necessary for Kane's equations are between unit vectors in the
{\it{same}} frame.  This means that the direction cosine matrix is never
needed to compute the dynamic equations of motion.  This is not the case in the
first formulation, specifically because the velocities of $A^*$ and $B^*$ have
terms in both the inertial frame $N$ and the body frame $A$.

To see the relationship between these two sets of equations, we compute the
inertia dyadic of fictitious particles of mass $m_a$ and $m_b$, located at
$A^*$ and $B^*$, respectively, relative to the system mass center $AB^*$.  They
are:
\begin{align*}
  \bs{I}^{A^* / AB^*} & =
  m_al_{3a}^2\bs{a}_1\bs{a}_1 + m_a(l_{1a}^2 + l_{3a}^2)\bs{a}_2 \bs{a}_2 +
  m_al_{1a}^2\bs{a}_3\bs{a}_3 -
  m_al_{1a}l_{3a}\bs{a}_1\bs{a}_3 - m_al_{1a}l_{3a}\bs{a}_3\bs{a}_1 \\
  \bs{I}^{B^* / AB^*} & =
  m_bl_{3b}^2\bs{a}_1\bs{a}_1 + m_b(l_{1b}^2 + l_{3b}^2)\bs{a}_2 \bs{a}_2 +
  m_bl_{1b}^2\bs{a}_3\bs{a}_3 -
  m_bl_{1b}l_{3b}\bs{a}_1\bs{a}_3 - m_bl_{1b}l_{3b}\bs{a}_3\bs{a}_1
\end{align*}
Additionally, consider the inertia dyadic of $B$ as being comprised of two
components, one in the plane of symmetry $(\bs{I}^{B/B^*}_p)$ and one about
the axis of symmetry $(\bs{I}^{B/B^*}_a)$:
\begin{align*}
  \bs{I}^{B/B^*} & = \bs{I}^{B/B^*}_p + \bs{I}^{B/B^*}_a \\
  & = (I\bs{a}_1\bs{a}_1 + I\bs{a}_3\bs{a}_3) + J\bs{a}_2\bs{a}_2
\end{align*}

Next, consider the inertia dyadic of the whole system, about the point $AB^*$,
{\it{except}} the out of plane component of the symmetric rotor $B$:
\begin{align*}
  \bs{I}^{AB/AB^*} & = \bs{I}^{A/A^*} + \bs{I}^{A^*/AB^*} + \bs{I}^{B/B^*}_p +
  \bs{I}^{B^*/AB^*} \\
  & = (I_{11} + m_a l_{3a}^2 + I + m_b l_{3b}^2) \bs{a}_1\bs{a}_1 \\
  &
  +
  (I_{22} + m_a(l_{1a}^2 + l_{3a}^2) + m_b(l_{1b}^2 + l_{3b}^2))\bs{a}_2\bs{a}_2
  \\
  &
  + (I_{33} + m_al_{1a}^2 + I + m_b l_{1b}^2) \bs{a}_3\bs{a}_3
  \\
  &
  +
  (I_{13} - m_a l_{1a}l_{3a} - m_b l_{1b}l_{3b}) \bs{a}_1\bs{a}_3
  +
  (I_{13} - m_a l_{1a}l_{3a} - m_b l_{1b}l_{3b}) \bs{a}_3\bs{a}_1
\end{align*}

Define the following inertia scalars:
\begin{align*}
  I_{\tilde{A}11} & = I_{11} + m_a l_{3a}^2 + I + m_b l_{3b}^2 \\
  I_{\tilde{A}22} & = I_{22} + m_a(l_{1a}^2 + l_{3a}^2) + m_b(l_{1b}^2 +
  l_{3b}^2) \\
  I_{\tilde{A}33} & = I_{33} + m_al_{1a}^2 + I + m_b l_{1b}^2 \\
  I_{\tilde{A}13} & = I_{13} - m_a l_{1a}l_{3a} - m_b l_{1b}l_{3b} \\
  \tilde{J} & = J
\end{align*}

Using these definitions, and substituting them into the equations of motion
obtained in the alternative formulation, we obtain identical equations of
motion as in the first formulation where each rigid body was treated
separately.

\section*{Conclusions}

The fundamental concept that allows for this lumping of rigid bodies is that
the inertia of the system not change with configuration (as generalized
coordinates change, the system inertia remains constant).  While it should be
clear that under these circumstances, inertia forces are identical for both
formulations, it may not be so clear that active forces are also the same.  In
the case of gravitational forces (as in this example), one can probably be
convinced that they may be treated as acting at the system center of mass
without much effort.  But what about contact forces, or systems with linear
motion constraints (nonholonomic constraints)?  The formulation of the
generalized active forces as advocated by Kane will be identical in either case
-- therefore the final equations of motion will also be the same.
Specifically, linear motion constraints will require the solution of constraint
equations (i.e., solving a linear system), so that nonholonomic partial
velocities and partial angular velocities can be formed.  These are independent
of inertial considerations and therefore will not affect the equations of
motion.

\end{document}
